{
  "cells": [
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "624b39df",
      "metadata": {
        "id": "624b39df"
      },
      "outputs": [],
      "source": [
        "import torch\n",
        "import torch.nn as nn\n",
        "from collections import defaultdict\n",
        "import torch.nn.functional as F\n",
        "from torch.utils.data import DataLoader, TensorDataset\n",
        "import tqdm\n",
        "import math\n",
        "from collections import defaultdict\n",
        "from torch.nn.utils.rnn import pad_sequence, pack_padded_sequence, pad_packed_sequence"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "e64dc269",
      "metadata": {
        "id": "e64dc269"
      },
      "outputs": [],
      "source": [
        "FILL_IN = \"FILL_IN\""
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "fa935c21",
      "metadata": {
        "id": "fa935c21"
      },
      "outputs": [],
      "source": [
        "# Dictionaries, {idx -> ch} and {ch -> idx}\n",
        "itos = defaultdict(int)\n",
        "stoi = defaultdict(int)\n",
        "# Embedding dimension, per character\n",
        "d_model = 10\n",
        "# Hidden dimension for RNN and also MLP Language Models\n",
        "d_h = 200\n",
        "\n",
        "# START = STOP token\n",
        "stoi['.'] = 0\n",
        "itos[0] = '.'\n",
        "\n",
        "# Fill in stoi and itoi; loop over names.txt\n",
        "with open('/content/names-1.txt', 'r') as file:\n",
        "    for line in file:\n",
        "        name = line.strip().lower()\n",
        "        for ch in name:\n",
        "            if ch not in stoi:\n",
        "                idx = len(stoi)\n",
        "                stoi[ch] = idx\n",
        "                itos[idx] = ch"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "d556793e",
      "metadata": {
        "id": "d556793e"
      },
      "outputs": [],
      "source": [
        "assert len(stoi) == len(itos)\n",
        "vocab_size = len(stoi)\n",
        "assert vocab_size == 27"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "a024f402",
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "a024f402",
        "outputId": "88bfbe99-f4dc-4f71-f55e-ba45492bde07"
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "{'.': 0,\n",
              " 'e': 1,\n",
              " 'm': 2,\n",
              " 'a': 3,\n",
              " 'o': 4,\n",
              " 'l': 5,\n",
              " 'i': 6,\n",
              " 'v': 7,\n",
              " 's': 8,\n",
              " 'b': 9,\n",
              " 'p': 10,\n",
              " 'h': 11,\n",
              " 'c': 12,\n",
              " 'r': 13,\n",
              " 't': 14,\n",
              " 'y': 15,\n",
              " 'n': 16,\n",
              " 'g': 17,\n",
              " 'z': 18,\n",
              " 'f': 19,\n",
              " 'd': 20,\n",
              " 'u': 21,\n",
              " 'k': 22,\n",
              " 'w': 23,\n",
              " 'q': 24,\n",
              " 'x': 25,\n",
              " 'j': 26}"
            ]
          },
          "metadata": {},
          "execution_count": 36
        }
      ],
      "source": [
        "stoi"
      ]
    },
    {
      "cell_type": "markdown",
      "id": "509fb63d",
      "metadata": {
        "id": "509fb63d"
      },
      "source": [
        "## Attention RNN Language Model\n",
        "- For each name, run an RNN character by character\n",
        "- Use the recursion x = Tanh()(Wh @ h + Wx @ x + bh + bx) and y = Softmax()(Wy h + by)\n",
        "- Do not use the RNN Cell from PyTorch, do this manually as hinted below\n",
        "- Use attention as below to get the pprediction at each time step and define the next hidden state\n",
        "- Token embedding size is d_model; d_h is the hidden size"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "c765e7fc",
      "metadata": {
        "id": "c765e7fc"
      },
      "outputs": [],
      "source": [
        "class AttentionRNNLanguageModel(nn.Module):\n",
        "    def __init__(self):\n",
        "        super().__init__()\n",
        "        # For each token, we have an embedding of size d_model\n",
        "        self.e = nn.Embedding(vocab_size, d_model)\n",
        "\n",
        "        # Wh and Wx act on h_t and x_t, respectively\n",
        "        self.Wh = nn.Linear(d_h, d_h, bias=True)\n",
        "        self.Wx = nn.Linear(d_model, d_h, bias=True)\n",
        "\n",
        "        # We will concatenate h_t and k_t to predict the y_t vector\n",
        "        self.Wy = nn.Linear(2 * d_h, vocab_size, bias=True)\n",
        "\n",
        "        # Attention is used to get scores e_{t, s} = h_s @ Wa @ h_t\n",
        "        self.Wa = nn.Linear(d_h, d_h, bias=False)\n",
        "\n",
        "    \"\"\"\n",
        "    Example schematic of this model:\n",
        "       c1    c2    c3    c4    c5\n",
        "\n",
        "       ^     ^     ^     ^     ^\n",
        "       |     |     |     |     |\n",
        "\n",
        "h0 ->  h1 -> h2 -> h3 -> h3 -> h4\n",
        "\n",
        "       ^     ^     ^     ^     ^\n",
        "       |     |     |     |     |\n",
        "\n",
        "       c0    c1    c2    c3    c4\n",
        "\n",
        "    As an example, to predict c3 take h3 with h2, h1\n",
        "    a3i = h3 @ hi with i <= 3\n",
        "    Apply softmax to a3i\n",
        "    k3 = a33 @ h3 + a32 @ h2 + a31@h1\n",
        "    Use k3 and h3 to predict c3\n",
        "    k3 really is [k3, h3] first and then we get the logits for c3\n",
        "\n",
        "    \"\"\"\n",
        "\n",
        "    # h_past here is the past history of hidden states\n",
        "    # At time 1, it is just h0\n",
        "    # At time 2, it is [h0, h1]\n",
        "    def forward(self, x, h_past):\n",
        "        # Run through to get the embedding for the token\n",
        "        # The embedding per token is the feature vector x  we pass into the\n",
        "        x = self.e(x)\n",
        "\n",
        "        # Get the last hidden state\n",
        "        h = h_past[-1]\n",
        "\n",
        "        # Use the last hidden state and the current token to get the new hidden state\n",
        "        # Pass through Tanh the combination of x and the last hidden state\n",
        "        h = torch.tanh(self.Wh(h) + self.Wx(x))\n",
        "\n",
        "        # Append the current state to the old states\n",
        "        # (h0, ..., h_{t-1}) becomes (h0, ..., h_{t-1}, h_t)\n",
        "        h_past = h_past + [h]\n",
        "\n",
        "        # Get the scores, which are given by e_{t, s} = h_s @ Wa @ h_t, a scalar\n",
        "        # Get all the real valued scores [e_{t, 0}, ..., e_{t, t}]\n",
        "        e = torch.cat([torch.matmul(h_s, self.Wa(h).T) for h_s in h_past], dim=0)\n",
        "\n",
        "        # From the scores, get the probabilities\n",
        "        # a_{t, 0} + ... + a_{t, t} = 1\n",
        "        a = F.softmax(e, dim=0)\n",
        "\n",
        "        # Define k_t as a_{t, 0} * h_0 + ... + a_{t, t} * h_t\n",
        "        k = sum(a[i] * h_past[i] for i in range(len(h_past)))\n",
        "\n",
        "        # Reset and define k_t as (k_t, h_t)\n",
        "        k = torch.cat((k, h), dim=-1)\n",
        "\n",
        "        # Get the logits which are Wy(k_t)\n",
        "        z = self.Wy(k)\n",
        "\n",
        "        # Return the logits and the current history of hidden states\n",
        "        return z, h_past"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "d3f16e01",
      "metadata": {
        "id": "d3f16e01"
      },
      "outputs": [],
      "source": [
        "model = AttentionRNNLanguageModel()\n",
        "# Try some learning rates of the type 10^{x} where x is between -1 and -10\n",
        "# Things should be going down, as below; use Adam\n",
        "lr = 10 ** -3\n",
        "optimizer = torch.optim.Adam(model.parameters(), lr=lr)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "96e989e4",
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "96e989e4",
        "outputId": "5a1dc956-3ad6-42d9-da75-9157983266bc"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "2.761822773218155\n",
            "2.500001883506775\n",
            "2.4331910359859465\n",
            "2.435374702215195\n",
            "2.3915527546405793\n",
            "2.3796905171871185\n",
            "2.298095943927765\n",
            "2.257773733139038\n",
            "2.296198455095291\n",
            "2.3828671407699584\n",
            "2.336710559129715\n",
            "2.31052477478981\n",
            "2.2905073273181915\n",
            "2.382414400577545\n",
            "2.322829065322876\n",
            "2.259001396894455\n",
            "2.3312281513214113\n",
            "2.3049275720119478\n",
            "2.348262461423874\n",
            "2.243504151105881\n",
            "2.3501744854450224\n",
            "2.299672852754593\n",
            "2.3140396809577943\n",
            "2.4118886411190035\n",
            "2.285489411354065\n",
            "2.2899625873565674\n",
            "2.261569081544876\n",
            "2.2870814776420594\n",
            "2.307613780498505\n",
            "2.1908396923542024\n",
            "2.2772640132904054\n",
            "2.351234210729599\n",
            "2.2411180114746094\n",
            "2.2733219289779663\n",
            "2.3198438143730162\n",
            "2.3274916934967043\n",
            "2.3406955564022063\n",
            "2.3272045969963076\n",
            "2.3025209772586823\n",
            "2.280151410102844\n",
            "2.2958524322509763\n",
            "2.3715776836872102\n",
            "2.2956756961345675\n",
            "2.32684681892395\n",
            "2.3386134123802185\n",
            "2.2735862910747526\n",
            "2.3216997480392454\n",
            "2.312634869813919\n",
            "2.292427718639374\n",
            "2.307159675359726\n",
            "2.330089455842972\n",
            "2.394450888633728\n",
            "2.3017629599571228\n",
            "2.3552595162391663\n",
            "2.3689788246154784\n",
            "2.3153083217144013\n",
            "2.2627530801296234\n",
            "2.309913567304611\n",
            "2.286564642190933\n",
            "2.3894179701805114\n",
            "2.3768155455589293\n",
            "2.37715700507164\n",
            "2.23712681889534\n",
            "2.266926474571228\n",
            "2.4238217949867247\n",
            "2.3446291208267214\n",
            "2.3391489470005036\n",
            "2.3074216508865355\n",
            "2.3416425514221193\n",
            "2.3195668148994444\n",
            "2.2772868037223817\n",
            "2.3137416076660156\n",
            "2.328077187538147\n",
            "2.2500120210647583\n",
            "2.267038756608963\n",
            "2.1768770384788514\n",
            "2.464357022047043\n",
            "2.391457850933075\n",
            "2.348042573928833\n",
            "2.2859653067588805\n",
            "2.3888908541202545\n",
            "2.2276513981819153\n",
            "2.409836766719818\n",
            "2.2547370970249174\n",
            "2.3201617312431337\n",
            "2.371799530982971\n",
            "2.290196759700775\n",
            "2.483335509300232\n",
            "2.260700463056564\n",
            "2.387521119117737\n",
            "2.3851506161689757\n",
            "2.2426879703998566\n",
            "2.2943444764614105\n",
            "2.328981338739395\n",
            "2.2684552705287935\n",
            "2.4522815215587617\n",
            "2.4157301115989687\n",
            "2.335915480852127\n",
            "2.239564981460571\n",
            "2.4060854649543764\n",
            "2.3630607664585113\n",
            "2.2326493537425995\n",
            "2.426508136987686\n",
            "2.455062792301178\n",
            "2.5234190034866333\n",
            "2.2020979428291323\n",
            "2.322175166606903\n",
            "2.49764688372612\n",
            "2.251724134683609\n",
            "2.227312779426575\n",
            "2.3080189633369446\n",
            "2.4873961877822874\n",
            "2.3684440076351168\n",
            "2.4079437124729157\n",
            "2.175937217473984\n",
            "2.33516455411911\n",
            "2.4436485958099365\n",
            "2.4908130741119385\n",
            "2.0797089290618898\n",
            "2.26418056845665\n",
            "2.35495658159256\n",
            "2.5772518920898437\n",
            "2.4147827982902528\n",
            "2.5200645422935484\n",
            "2.1854053354263305\n",
            "2.208632482290268\n",
            "2.3318511807918547\n",
            "2.2398032319545744\n",
            "2.5194918942451476\n",
            "2.145668865442276\n",
            "2.086526327133179\n",
            "2.3804378724098205\n",
            "2.22717280626297\n",
            "2.5899697136878967\n",
            "2.3022053158283233\n",
            "2.4127941167354585\n",
            "2.564785506725311\n",
            "2.3243574404716494\n",
            "2.065182874202728\n",
            "2.3255662727355957\n",
            "2.105727472305298\n",
            "2.255128390789032\n",
            "2.408682360649109\n",
            "2.7547561264038087\n",
            "2.2215550220012665\n",
            "2.0978340351581575\n",
            "2.0126207411289214\n",
            "2.3095026445388793\n",
            "2.3456801199913024\n",
            "2.1784608650207518\n",
            "2.3930452156066893\n",
            "2.5287500846385957\n",
            "2.313913370370865\n",
            "2.2684072279930114\n",
            "2.4021847796440126\n",
            "2.2911498606204987\n",
            "2.2256406700611113\n",
            "2.0074337464571\n",
            "2.2104669785499573\n",
            "2.3432281029224398\n",
            "2.1650972402095796\n",
            "2.193727352619171\n",
            "2.2798866748809816\n",
            "2.4672992062568664\n",
            "2.450275893211365\n",
            "2.191718200445175\n",
            "2.03181525349617\n",
            "2.1353971207141877\n",
            "2.0563042438030243\n",
            "2.284197808504105\n",
            "2.3543165957927705\n",
            "1.8619450730085374\n",
            "2.198861749172211\n",
            "2.443788135051727\n",
            "2.6408414793014527\n",
            "2.3688818442821504\n",
            "2.1529826140403747\n",
            "2.399759967327118\n",
            "2.467245886325836\n",
            "2.348991035223007\n",
            "2.5295333707332612\n",
            "2.508959035873413\n",
            "2.4498518812656402\n",
            "2.4371617329120636\n",
            "2.4836047065258025\n",
            "2.3811165857315064\n",
            "2.5172950530052187\n",
            "2.452851198911667\n",
            "2.4274133801460267\n",
            "2.434794669151306\n",
            "2.479454780817032\n",
            "2.489704291820526\n",
            "2.4095319831371307\n",
            "2.4401486587524412\n",
            "2.409522521495819\n",
            "2.4535317397117615\n",
            "2.4224071741104125\n",
            "2.467662236690521\n",
            "2.447632219791412\n",
            "2.515135997533798\n",
            "2.479998689889908\n",
            "2.4369170367717743\n",
            "2.4908034098148346\n",
            "2.5156107151508333\n",
            "2.432129876613617\n",
            "2.4238397061824797\n",
            "2.4750097358226775\n",
            "2.4199232625961304\n",
            "2.435560579299927\n",
            "2.3191268610954285\n",
            "2.419281007051468\n",
            "2.408433771133423\n",
            "2.451994082927704\n",
            "2.467998640537262\n",
            "2.3931277656555174\n",
            "2.489296211004257\n",
            "2.4570259928703306\n",
            "2.446492992639542\n",
            "2.496898573637009\n",
            "2.4517073965072633\n",
            "2.546953067779541\n",
            "2.4018353915214536\n",
            "2.454289630651474\n",
            "2.4877594649791717\n",
            "2.505827766656876\n",
            "2.4242771673202514\n",
            "2.444488219022751\n",
            "2.565459738969803\n",
            "2.5073661065101622\n",
            "2.364826340675354\n",
            "2.5626354277133943\n",
            "2.507616022825241\n",
            "2.471540312767029\n",
            "2.4453542649745943\n",
            "2.520500727891922\n",
            "2.5087537968158724\n",
            "2.486327724456787\n",
            "2.4863544619083404\n",
            "2.5263287246227266\n",
            "2.453612960577011\n",
            "2.4867483723163604\n",
            "2.470229425430298\n",
            "2.5118414425849913\n",
            "2.5148941648006438\n",
            "2.558008794784546\n",
            "2.5717054128646852\n",
            "2.596933923959732\n",
            "2.4112727880477904\n",
            "2.5151086223125456\n",
            "2.5485033237934114\n",
            "2.5165763986110687\n",
            "2.3054142880439756\n",
            "2.5456995368003845\n",
            "2.263936879634857\n",
            "2.6214194869995118\n",
            "2.633017570972443\n",
            "2.460215812921524\n",
            "2.6239060759544373\n",
            "2.2876077628135683\n",
            "2.7022913193702696\n",
            "2.6342596566677092\n",
            "2.526013295650482\n",
            "2.3374366772174837\n",
            "2.5214682710170746\n",
            "2.272585639953613\n",
            "2.5253637766838075\n",
            "2.5338498616218565\n",
            "2.619248685836792\n",
            "2.465464903116226\n",
            "2.4275972938537596\n",
            "2.4905429494380953\n",
            "2.2872615003585817\n",
            "2.327152907848358\n",
            "2.662651439905167\n",
            "2.6256613755226135\n",
            "2.616411566734314\n",
            "2.588101713657379\n",
            "2.4628667879104613\n",
            "2.3223825454711915\n",
            "2.5750156056880953\n",
            "2.476445982456207\n",
            "2.3558543980121613\n",
            "2.4174317610263825\n",
            "2.5200672793388366\n",
            "2.7371772718429566\n",
            "2.4112036490440367\n",
            "2.5513325357437133\n",
            "2.5301432323455813\n",
            "2.38651820898056\n",
            "2.43433336019516\n",
            "2.3253412294387816\n",
            "2.6024462366104126\n",
            "2.665517635345459\n",
            "2.1143746089935305\n",
            "2.2575421643257143\n",
            "2.571126674413681\n",
            "2.419289507865906\n",
            "2.7688275110721587\n",
            "2.4788771152496336\n",
            "2.4824776780605315\n",
            "2.5800525414943696\n",
            "2.7370889830589293\n",
            "2.280031703710556\n",
            "2.455895345211029\n",
            "2.3707218396663667\n",
            "2.253951495885849\n",
            "2.440217468738556\n",
            "2.743819154500961\n",
            "2.618461105823517\n",
            "2.0832128918170927\n",
            "2.3181249046325685\n",
            "2.1111253154277803\n",
            "2.466727911233902\n",
            "2.5122577893733977\n",
            "2.5376507210731507\n",
            "2.809264954328537\n",
            "2.494681897163391\n",
            "2.454287600517273\n",
            "2.377620930671692\n",
            "2.676343493461609\n",
            "2.5605950129032133\n",
            "2.3265275073051455\n",
            "2.258457226753235\n",
            "2.233985005021095\n",
            "2.247375463247299\n",
            "2.254268093109131\n",
            "2.175543315410614\n",
            "2.1591397309303284\n",
            "2.199271672964096\n",
            "2.2511052787303925\n",
            "2.210081045627594\n",
            "2.22650252699852\n",
            "2.169348565340042\n",
            "2.2621434211730955\n",
            "2.2411762964725495\n",
            "2.1549795830249785\n",
            "2.1410601532459257\n",
            "2.2458683359622955\n",
            "2.223344088792801\n",
            "2.240713869333267\n",
            "2.205108119249344\n",
            "2.28474550485611\n",
            "2.218926286697388\n",
            "2.323311142921448\n",
            "2.2813211989402773\n",
            "2.2216789758205415\n",
            "2.181205893754959\n",
            "2.192174633741379\n",
            "2.219696946144104\n",
            "2.209647870063782\n",
            "2.2005402624607084\n",
            "2.221269527673721\n",
            "2.2063133549690246\n",
            "2.2376594138145447\n",
            "2.247365099191666\n",
            "2.2367278039455414\n",
            "2.259208323955536\n",
            "2.269599792957306\n",
            "2.2389819526672365\n",
            "2.2491919791698454\n",
            "2.1949960911273956\n",
            "2.325747705698013\n",
            "2.24662791967392\n",
            "2.3486067163944244\n",
            "2.2572930920124055\n",
            "2.3216213274002073\n",
            "2.3138000094890594\n",
            "2.2058264350891115\n",
            "2.221867860555649\n",
            "2.33294717669487\n",
            "2.2110822010040283\n",
            "2.299454629421234\n",
            "2.319149694442749\n",
            "2.2382527351379395\n",
            "2.3409812462329866\n",
            "2.316027226448059\n",
            "2.241798404455185\n",
            "2.2091801238059996\n",
            "2.2715767097473143\n",
            "2.362592784166336\n",
            "2.3130886161327364\n",
            "2.280461791753769\n",
            "2.3115925693511965\n",
            "2.1359553754329683\n",
            "2.35474432349205\n",
            "2.193638470172882\n",
            "2.2885852539539338\n",
            "2.383044400215149\n",
            "2.25986283659935\n",
            "2.263269095420837\n",
            "2.4215359830856324\n",
            "2.2546014440059663\n",
            "2.172920583486557\n",
            "2.279455350637436\n",
            "2.2683608746528625\n",
            "2.1346277844905854\n",
            "2.368423637151718\n",
            "2.3591937816143034\n",
            "2.3781354987621306\n",
            "2.147254182100296\n",
            "2.4157167506217956\n",
            "2.1868190813064574\n",
            "2.3217447996139526\n",
            "2.2598892498016356\n",
            "2.272033830881119\n",
            "2.4959829580783843\n",
            "2.198227438926697\n",
            "2.3707735574245454\n",
            "2.2110496199131013\n",
            "2.3374046444892884\n",
            "2.4209296000003815\n",
            "2.1842338109016417\n",
            "2.2277984297275544\n",
            "2.352246421575546\n",
            "2.1709505307674406\n",
            "2.2825946629047396\n",
            "2.549904216527939\n",
            "2.4149439299106596\n",
            "2.1038256871700285\n",
            "2.3610943794250487\n",
            "2.3738820862770083\n",
            "2.2207355809211733\n",
            "2.3606620943546295\n",
            "2.4565535485744476\n",
            "2.45755877494812\n",
            "2.239645018577576\n",
            "2.2105400800704955\n",
            "2.328483564853668\n",
            "2.4131356930732726\n",
            "2.1166212046146393\n",
            "2.3427621948719026\n",
            "2.3852194368839266\n",
            "2.3905517411231996\n",
            "2.495250161886215\n",
            "2.155300650596619\n",
            "2.32852166056633\n",
            "2.2851954710483553\n",
            "2.5767833149433135\n",
            "2.1005147767066954\n",
            "2.17754962682724\n",
            "2.273023360967636\n",
            "2.6063809156417848\n",
            "2.399165300130844\n",
            "2.4453792035579682\n",
            "2.3190017199516295\n",
            "2.1264418888092043\n",
            "2.308424314260483\n",
            "2.3004919445514678\n",
            "2.3515806102752688\n",
            "2.2657443392276764\n",
            "2.1378510332107545\n",
            "2.184714858531952\n",
            "2.3495295071601867\n",
            "2.3664733636379243\n",
            "2.381462322473526\n",
            "2.275109113454819\n",
            "2.616209360361099\n",
            "2.395274885892868\n",
            "2.0046159613132475\n",
            "2.2005781650543215\n",
            "2.193886046409607\n",
            "2.2308099448680876\n",
            "2.233789690732956\n",
            "2.6707610869407654\n",
            "2.4753934037685394\n",
            "1.9234225594997405\n",
            "2.05751810669899\n",
            "2.1867710173130037\n",
            "2.324269179105759\n",
            "2.1592120862007143\n",
            "2.2999370783567428\n",
            "2.5422567653656007\n",
            "2.3199442613124845\n",
            "2.222121104001999\n",
            "2.3530751025676726\n",
            "2.3955257880687713\n",
            "2.26296035528183\n",
            "1.933243087530136\n",
            "2.1011433386802674\n",
            "2.159368584156036\n",
            "2.2933899730443956\n",
            "2.1233914256095887\n",
            "2.0901300370693208\n",
            "2.298072739839554\n",
            "2.5312359821796417\n",
            "2.3717872214317324\n",
            "1.9076712018251418\n",
            "2.052215061187744\n",
            "1.834311807155609\n",
            "2.257036300897598\n",
            "2.174020148515701\n",
            "2.0049398916959764\n",
            "2.0057818442583084\n",
            "2.4150941050052643\n",
            "2.635237191915512\n",
            "2.337935354709625\n",
            "2.1237043941020968\n",
            "2.40245671749115\n",
            "2.3435266995429993\n",
            "2.452997601032257\n",
            "2.351597306728363\n",
            "2.3701407885551453\n",
            "2.5329145216941833\n",
            "2.399383957386017\n",
            "2.4147170174121855\n",
            "2.400264480113983\n",
            "2.3615603220462797\n",
            "2.396340322494507\n",
            "2.4002911591529847\n",
            "2.4738291132450105\n",
            "2.4229649472236634\n",
            "2.5717679393291473\n",
            "2.4207824778556826\n",
            "2.3765517401695253\n",
            "2.40504039645195\n",
            "2.436203590631485\n",
            "2.3559468400478365\n",
            "2.404211404323578\n",
            "2.4116707146167755\n",
            "2.4901820039749145\n",
            "2.4131043577194213\n",
            "2.480963797569275\n",
            "2.5157709312438965\n",
            "2.461835137605667\n",
            "2.4525937855243685\n",
            "2.4688062596321108\n",
            "2.35545005440712\n",
            "2.4671080601215363\n",
            "2.400479207038879\n",
            "2.29760129570961\n",
            "2.3865694320201873\n",
            "2.356819750070572\n",
            "2.4670922541618348\n",
            "2.423545540571213\n",
            "2.4514221072196962\n",
            "2.393499330282211\n",
            "2.440820784568787\n",
            "2.431034369468689\n",
            "2.4437681460380554\n",
            "2.468967649936676\n",
            "2.5625514566898344\n",
            "2.395534119606018\n",
            "2.4719975996017456\n",
            "2.5007359099388125\n",
            "2.4665151584148406\n",
            "2.4189919567108156\n",
            "2.494874142408371\n",
            "2.523686604499817\n",
            "2.5169726252555846\n",
            "2.422063776254654\n",
            "2.5154676127433775\n",
            "2.491765992641449\n",
            "2.419871972799301\n",
            "2.4832379853725435\n",
            "2.434292368888855\n",
            "2.5313469529151917\n",
            "2.464902387857437\n",
            "2.616038107872009\n",
            "2.4643704867362977\n",
            "2.4378724706172945\n",
            "2.527301642894745\n",
            "2.467887395620346\n",
            "2.517169671058655\n",
            "2.4814959061145783\n",
            "2.5468094146251676\n",
            "2.522483458518982\n",
            "2.5166153371334077\n",
            "2.5526945507526397\n",
            "2.4560728418827056\n",
            "2.39873544216156\n",
            "2.527792350053787\n",
            "2.411688953638077\n",
            "2.452804673910141\n",
            "2.3216259491443636\n",
            "2.521648292541504\n",
            "2.5762876534461974\n",
            "2.5637829554080964\n",
            "2.47264616727829\n",
            "2.380555772781372\n",
            "2.508096936941147\n",
            "2.6385446906089784\n",
            "2.618227415084839\n",
            "2.349833369255066\n",
            "2.4632132160663605\n",
            "2.398771651983261\n",
            "2.3402862310409547\n",
            "2.60685063123703\n",
            "2.630254029035568\n",
            "2.557133572101593\n",
            "2.3500535750389098\n",
            "2.4442389118671417\n",
            "2.393059936761856\n",
            "2.2099530482292176\n",
            "2.6012069606781005\n",
            "2.64792791724205\n",
            "2.5175155639648437\n",
            "2.7238653087615967\n",
            "2.3663229966163635\n",
            "2.367665065526962\n",
            "2.4135803711414336\n",
            "2.6994874382019045\n",
            "2.367706605195999\n",
            "2.2838829255104063\n",
            "2.4306170356273653\n",
            "2.7207937347888946\n",
            "2.415880187749863\n",
            "2.490694760084152\n",
            "2.592063001394272\n",
            "2.355688238143921\n",
            "2.355043987035751\n",
            "2.3434273958206178\n",
            "2.376289426088333\n",
            "2.672402594089508\n",
            "2.24156166434288\n",
            "2.2807354199886323\n",
            "2.371993498802185\n",
            "2.3566429209709168\n",
            "2.780980498790741\n",
            "2.572761595249176\n",
            "2.3450986909866334\n",
            "2.617039186954498\n",
            "2.687484483718872\n",
            "2.3140822887420653\n",
            "2.478141515254974\n",
            "2.232805483341217\n",
            "2.3025001704692842\n",
            "2.343521420955658\n",
            "2.6523527455329896\n",
            "2.5567588949203492\n",
            "2.115581352710724\n",
            "2.24389133810997\n",
            "2.181890413761139\n",
            "2.328514722585678\n",
            "2.5177247595787047\n",
            "2.495709524154663\n",
            "2.68039018034935\n",
            "2.477823761701584\n",
            "2.4373846042156218\n",
            "2.307693593502045\n",
            "2.6934155118465424\n",
            "2.49540894985199\n",
            "2.387524573802948\n",
            "2.275095298290253\n",
            "2.1830157506465913\n",
            "2.2915476763248446\n",
            "2.252375606298447\n",
            "2.1491793715953826\n",
            "2.2085996770858767\n",
            "2.104132436513901\n",
            "2.206365420818329\n",
            "2.2315978986024856\n",
            "2.1579849451780317\n",
            "2.122260196208954\n",
            "2.204039011001587\n",
            "2.270575680732727\n",
            "2.1442405807971956\n",
            "2.152503230571747\n",
            "2.1972884809970856\n",
            "2.1877733850479126\n",
            "2.222495460510254\n",
            "2.159179068803787\n",
            "2.2839691865444185\n",
            "2.244705802202225\n",
            "2.24761936545372\n",
            "2.291495780944824\n",
            "2.2341717684268954\n",
            "2.1805597925186158\n",
            "2.1574237072467803\n",
            "2.1793238431215287\n",
            "2.192195035815239\n",
            "2.24569682598114\n",
            "2.238444756269455\n",
            "2.2586018872261047\n",
            "2.2428722286224367\n",
            "2.1891496348381043\n",
            "2.261722843647003\n",
            "2.1988089764118195\n",
            "2.3257636606693266\n",
            "2.305454592704773\n",
            "2.2066426360607148\n",
            "2.193260371685028\n",
            "2.2884663593769075\n",
            "2.286440899372101\n",
            "2.3264766001701354\n",
            "2.3512196910381316\n",
            "2.2536592853069304\n",
            "2.229647572040558\n",
            "2.2326281702518465\n",
            "2.213024206161499\n",
            "2.257270392179489\n",
            "2.3504783701896668\n",
            "2.247845470905304\n",
            "2.2640948271751404\n",
            "2.3718382441997528\n",
            "2.3439699172973634\n",
            "2.314962629079819\n",
            "2.3371045911312103\n",
            "2.195642921924591\n",
            "2.278645581007004\n",
            "2.239052540063858\n",
            "2.2706475603580474\n",
            "2.3576666367053987\n",
            "2.340614541769028\n",
            "2.2384471774101256\n",
            "2.2753373622894286\n",
            "2.1752693581581117\n",
            "2.2897801983356474\n",
            "2.419693089723587\n",
            "2.2230321407318114\n",
            "2.319309812784195\n",
            "2.406946841478348\n",
            "2.243146560192108\n",
            "2.2498836636543276\n",
            "2.29033505320549\n",
            "2.1490000355243684\n",
            "2.220837619304657\n",
            "2.3189782416820526\n",
            "2.3776552546024323\n",
            "2.3035673916339876\n",
            "2.1864387941360475\n",
            "2.331357066631317\n",
            "2.314016281366348\n",
            "2.1783571898937226\n",
            "2.287993297576904\n",
            "2.303649945259094\n",
            "2.444913005232811\n",
            "2.211350156068802\n",
            "2.3046715772151947\n",
            "2.2718268156051638\n",
            "2.212961200475693\n",
            "2.4047565519809724\n",
            "2.3507403600215913\n",
            "2.1907809829711913\n",
            "2.334992001056671\n",
            "2.212446970939636\n",
            "2.1872011721134186\n",
            "2.605691233873367\n",
            "2.388362755775452\n",
            "2.1200607478618623\n",
            "2.2727909934520723\n",
            "2.4312801229953767\n",
            "2.1116522121429444\n",
            "2.259571850299835\n",
            "2.5006348025798797\n",
            "2.4003688824176788\n",
            "2.3664550840854646\n",
            "2.21986178278923\n",
            "2.226306537389755\n",
            "2.485045087337494\n",
            "2.1380344140529632\n",
            "2.259879547357559\n",
            "2.2749600994586943\n",
            "2.4115214800834655\n",
            "2.531277930736542\n",
            "2.252162401676178\n",
            "2.277449806928635\n",
            "2.381847904920578\n",
            "2.4035294818878175\n",
            "2.173566702604294\n",
            "2.135448145866394\n",
            "2.3091939544677733\n",
            "2.324112730026245\n",
            "2.6133828032016755\n",
            "2.422371779680252\n",
            "2.392660254240036\n",
            "2.091149951219559\n",
            "2.176591441631317\n",
            "2.2391163551807405\n",
            "2.336303479671478\n",
            "2.40765251159668\n",
            "2.0399867737293245\n",
            "2.0427364075183867\n",
            "2.2900074172019957\n",
            "2.2614640963077544\n",
            "2.4789702355861665\n",
            "2.2386122012138365\n",
            "2.5257183003425596\n",
            "2.43520277261734\n",
            "2.1109857881069183\n",
            "2.141360594034195\n",
            "2.1815683484077453\n",
            "2.2186035376787188\n",
            "2.174967203140259\n",
            "2.428582602739334\n",
            "2.569950467348099\n",
            "1.9864877450466156\n",
            "2.1034984183311463\n",
            "2.05174067735672\n",
            "2.282090904712677\n",
            "2.17572649538517\n",
            "2.209556167125702\n",
            "2.428131319284439\n",
            "2.3564112615585326\n",
            "2.2346557354927064\n",
            "2.3470309603214266\n",
            "2.5299493527412413\n",
            "2.1211235237121584\n",
            "2.096141012907028\n",
            "1.9560550141334534\n",
            "2.1707343924045563\n",
            "2.2051269173622132\n",
            "2.10339825630188\n",
            "2.040818545818329\n",
            "2.3622464573383333\n",
            "2.4983134484291076\n",
            "2.5173795366287233\n",
            "1.9106730794906617\n",
            "2.1126029485464097\n",
            "1.869471619129181\n",
            "2.1065888100862504\n",
            "2.0606516432762145\n",
            "2.1933317476511003\n",
            "1.9757305645942689\n",
            "2.252513608932495\n",
            "2.4485763639211653\n",
            "2.516999051570892\n",
            "2.2907466006278994\n",
            "2.266296225786209\n",
            "2.3163867020606994\n",
            "2.496470878124237\n",
            "2.2162924718856813\n",
            "2.5701482379436493\n",
            "2.4483781957626345\n",
            "2.388229546546936\n",
            "2.49298348069191\n",
            "2.4251240825653078\n",
            "2.3699380350112915\n",
            "2.372317650318146\n",
            "2.369902242422104\n",
            "2.487529321908951\n",
            "2.432376405000687\n",
            "2.5137124252319336\n",
            "2.478478562831879\n",
            "2.3778488397598267\n",
            "2.3108490347862243\n",
            "2.391119807958603\n",
            "2.3521059477329254\n",
            "2.3700488090515135\n",
            "2.4507251310348512\n",
            "2.4808795845508573\n",
            "2.373215559720993\n",
            "2.4793591570854185\n",
            "2.5032461977005003\n",
            "2.4649284052848817\n",
            "2.4648823881149293\n",
            "2.4308687508106233\n",
            "2.3974931979179384\n",
            "2.4091077971458437\n",
            "2.3986208963394167\n",
            "2.3309728896617887\n",
            "2.3431470608711242\n",
            "2.4606172645092013\n",
            "2.453817197084427\n",
            "2.3872476375102996\n",
            "2.4947006690502165\n",
            "2.413324021100998\n",
            "2.378126963376999\n",
            "2.4319395899772642\n",
            "2.4402367055416105\n",
            "2.455556197166443\n",
            "2.517591942548752\n",
            "2.4304881358146666\n",
            "2.460241366624832\n",
            "2.3760295760631562\n",
            "2.443694567680359\n",
            "2.451376305818558\n",
            "2.437539759874344\n",
            "2.5225203907489777\n",
            "2.6003104460239412\n",
            "2.4601399159431456\n",
            "2.3965754246711732\n",
            "2.5776761281490326\n",
            "2.4429468369483947\n",
            "2.5527485060691832\n",
            "2.418383959531784\n",
            "2.547520320415497\n",
            "2.4988834714889525\n",
            "2.533935202360153\n",
            "2.4281919944286345\n",
            "2.446479032039642\n",
            "2.652690750360489\n",
            "2.41210621714592\n",
            "2.4300763392448426\n",
            "2.6489693319797514\n",
            "2.412557901144028\n",
            "2.5323869907855987\n",
            "2.5794104492664336\n",
            "2.5655346047878265\n",
            "2.3795312893390657\n",
            "2.403638151884079\n",
            "2.5499123191833495\n",
            "2.493230946063995\n",
            "2.344880436658859\n",
            "2.4729815411567686\n",
            "2.3499567258358\n",
            "2.6047016942501067\n",
            "2.587941942214966\n",
            "2.3562538087368012\n",
            "2.484609429836273\n",
            "2.4509126782417296\n",
            "2.6628191471099854\n",
            "2.631025595664978\n",
            "2.425981559753418\n",
            "2.479820486307144\n",
            "2.4944329166412356\n",
            "2.276247888803482\n",
            "2.6172883713245394\n",
            "2.5307408916950225\n",
            "2.62047961473465\n",
            "2.4275055038928985\n",
            "2.385184463262558\n",
            "2.56207612156868\n",
            "2.141203418970108\n",
            "2.4388105452060698\n",
            "2.6410086500644683\n",
            "2.528160547018051\n",
            "2.6286627674102783\n",
            "2.48086101770401\n",
            "2.4391431963443755\n",
            "2.2706275188922884\n",
            "2.7452295279502867\n",
            "2.2967385768890383\n",
            "2.3031838262081146\n",
            "2.5052149081230164\n",
            "2.691991118192673\n",
            "2.5520508921146394\n",
            "2.2981348133087156\n",
            "2.6012930512428283\n",
            "2.549510447978973\n",
            "2.445039106607437\n",
            "2.3866067469120025\n",
            "2.359858829975128\n",
            "2.653042733669281\n",
            "2.4113702523708342\n",
            "2.222612198591232\n",
            "2.1252549195289614\n",
            "2.4896433424949644\n",
            "2.5871292662620546\n",
            "2.584743331670761\n",
            "2.5535538172721863\n",
            "2.5101167166233065\n",
            "2.6100052416324617\n",
            "2.4287302887439726\n",
            "2.3646528267860414\n",
            "2.330120815038681\n",
            "2.3818908309936524\n",
            "2.139460242986679\n",
            "2.6854182291030884\n",
            "2.5096001410484314\n",
            "2.518563108444214\n",
            "2.0589615970849993\n",
            "2.3331647753715514\n",
            "2.151452977657318\n",
            "2.5294540131092074\n",
            "2.4194968438148496\n",
            "2.676048113107681\n",
            "2.6114680421352388\n",
            "2.4305485022068023\n",
            "2.4986517333984377\n",
            "2.5209986960887907\n",
            "2.465772886276245\n",
            "2.549073655605316\n",
            "2.23376771569252\n",
            "2.191673048734665\n",
            "2.222006690502167\n",
            "2.171112232208252\n",
            "2.205235105752945\n",
            "2.1088468158245086\n",
            "2.1531847596168516\n",
            "2.1907502806186674\n",
            "2.270115621089935\n",
            "2.1976585531234742\n",
            "2.1652296018600463\n",
            "2.170015959739685\n",
            "2.2362931072711945\n",
            "2.149855479001999\n",
            "2.215854073762894\n",
            "2.210914752483368\n",
            "2.2194018077850344\n",
            "2.2288576900959014\n",
            "2.154338992834091\n",
            "2.2701608967781066\n",
            "2.267508771419525\n",
            "2.24194219827652\n",
            "2.3094518530368804\n",
            "2.1896794641017916\n",
            "2.195314471721649\n",
            "2.2390412771701813\n",
            "2.1885963118076326\n",
            "2.2262349033355715\n",
            "2.158870700597763\n",
            "2.205562838315964\n",
            "2.260476108789444\n",
            "2.177280170917511\n",
            "2.168320678472519\n",
            "2.21062402844429\n",
            "2.2600367963314056\n",
            "2.2673911440372465\n",
            "2.2612795031070707\n",
            "2.2553099727630617\n",
            "2.2119053661823274\n",
            "2.236220589876175\n",
            "2.3099612724781036\n",
            "2.2420042848587034\n",
            "2.3122445845603945\n",
            "2.2852076482772827\n",
            "2.197412588596344\n",
            "2.307067494392395\n",
            "2.2488687193393706\n",
            "2.229897446632385\n",
            "2.288216577768326\n",
            "2.2756730341911315\n",
            "2.2815322959423066\n",
            "2.3082081270217896\n",
            "2.3055384480953216\n",
            "2.3343554699420928\n",
            "2.2982832157611846\n",
            "2.225367439985275\n",
            "2.303040611743927\n",
            "2.2148826730251314\n",
            "2.2826290988922118\n",
            "2.260825870037079\n",
            "2.3367368710041045\n",
            "2.1942136323451997\n",
            "2.2090710747241973\n",
            "2.379567062854767\n",
            "2.2713175189495085\n",
            "2.3738469099998474\n",
            "2.2520087802410127\n",
            "2.255309340953827\n",
            "2.2908187568187715\n",
            "2.2950031220912934\n",
            "2.2968309700489042\n",
            "2.294280962944031\n",
            "2.1899133682250977\n",
            "2.2364833414554597\n",
            "2.1768301510810852\n",
            "2.430197639465332\n",
            "2.334155933856964\n",
            "2.3232190942764284\n",
            "2.246553702354431\n",
            "2.3538545393943786\n",
            "2.1754189705848694\n",
            "2.318049021959305\n",
            "2.220170316696167\n",
            "2.316934926509857\n",
            "2.3070453119277956\n",
            "2.270744597911835\n",
            "2.3758964741230013\n",
            "2.263825639486313\n",
            "2.289093667268753\n",
            "2.417559769153595\n",
            "2.1992157208919525\n",
            "2.2026116812229155\n",
            "2.2964437317848208\n",
            "2.2615732288360597\n",
            "2.3865512347221376\n",
            "2.378994228839874\n",
            "2.215180125236511\n",
            "2.19905055642128\n",
            "2.353306609392166\n",
            "2.2830319344997405\n",
            "2.2339662742614745\n",
            "2.4111769008636474\n",
            "2.396569150686264\n",
            "2.4884873259067537\n",
            "2.1396545696258547\n",
            "2.2599282801151275\n",
            "2.4703071939945223\n",
            "2.2232086956501007\n",
            "2.2008934879302977\n",
            "2.2489210176467895\n",
            "2.454089173078537\n",
            "2.3609067845344542\n",
            "2.412991851568222\n",
            "2.1167105197906495\n",
            "2.267221586704254\n",
            "2.4117741000652315\n",
            "2.430599673986435\n",
            "2.000360658168793\n",
            "2.304607503414154\n",
            "2.323033446073532\n",
            "2.623185296058655\n",
            "2.419287557601929\n",
            "2.5394159758090975\n",
            "2.0853205382823945\n",
            "2.1524258363246918\n",
            "2.2533369863033297\n",
            "2.1861495196819307\n",
            "2.4957081151008604\n",
            "2.0728815841674804\n",
            "2.010557522773743\n",
            "2.338434735536575\n",
            "2.244921656847\n",
            "2.5601508128643036\n",
            "2.2389269149303437\n",
            "2.39573392868042\n",
            "2.525826907157898\n",
            "2.268922905921936\n",
            "2.089849590063095\n",
            "2.2489335417747496\n",
            "2.0257007110118868\n",
            "2.2795999383926393\n",
            "2.381954184770584\n",
            "2.622509058713913\n",
            "2.1676385498046873\n",
            "2.0863689106702803\n",
            "1.9550006771087647\n",
            "2.2662797236442564\n",
            "2.3019155609607695\n",
            "2.1920263826847077\n",
            "2.3433677804470063\n",
            "2.4979272270202637\n",
            "2.303597515821457\n",
            "2.344814896583557\n",
            "2.4847692477703096\n",
            "2.200625945329666\n",
            "2.201292985677719\n",
            "1.9735049462318421\n",
            "2.111175454854965\n",
            "2.2619730794429778\n",
            "2.049195009469986\n",
            "2.1000128531455995\n",
            "2.2190277194976806\n",
            "2.4825518524646757\n",
            "2.4334481918811797\n",
            "2.1392373132705687\n",
            "1.9978918576240539\n",
            "2.025287449359894\n",
            "1.9935212111473084\n",
            "2.1467973864078522\n",
            "2.325423538684845\n",
            "1.8748767536878586\n",
            "2.2309591019153596\n",
            "2.472499670982361\n",
            "2.622296282052994\n",
            "2.309619381427765\n",
            "2.1600109350681307\n",
            "2.402319084405899\n",
            "2.4857053244113922\n",
            "2.2623996710777283\n",
            "2.4858954167366027\n",
            "2.3999989402294157\n",
            "2.372348530292511\n",
            "2.422175394296646\n",
            "2.45774875164032\n",
            "2.3786990523338316\n",
            "2.382794941663742\n",
            "2.3758598458766937\n",
            "2.3865618884563444\n",
            "2.4731099915504458\n",
            "2.4299482035636903\n",
            "2.466557105779648\n",
            "2.3709957790374756\n",
            "2.3508752954006193\n",
            "2.3699294364452363\n",
            "2.3558358013629914\n",
            "2.343332244157791\n",
            "2.443194476366043\n",
            "2.3883169114589693\n",
            "2.4484758949279786\n",
            "2.4189470517635345\n",
            "2.5070958280563356\n",
            "2.405301957130432\n",
            "2.5454364788532255\n",
            "2.417499442100525\n",
            "2.3948957347869873\n",
            "2.447975242137909\n",
            "2.390097517967224\n",
            "2.4077401316165923\n",
            "2.344986969232559\n",
            "2.4217581474781036\n",
            "2.4394294023513794\n",
            "2.41094584107399\n",
            "2.471159851551056\n",
            "2.3822438204288483\n",
            "2.4888360357284545\n",
            "2.428571516275406\n",
            "2.4346220576763153\n",
            "2.544690603017807\n",
            "2.424640609025955\n",
            "2.499550986289978\n",
            "2.3429183185100557\n",
            "2.377113473415375\n",
            "2.500982940196991\n",
            "2.455519551038742\n",
            "2.3854397892951966\n",
            "2.4330021893978118\n",
            "2.5795198035240174\n",
            "2.5069302415847776\n",
            "2.3166466796398164\n",
            "2.555145267248154\n",
            "2.551734472513199\n",
            "2.421410233974457\n",
            "2.4528266537189483\n",
            "2.527185173034668\n",
            "2.467667943239212\n",
            "2.4680374372005462\n",
            "2.4973923242092133\n",
            "2.5460026979446413\n",
            "2.4948455929756164\n",
            "2.5035122907161713\n",
            "2.4465985238552093\n",
            "2.5537341594696046\n",
            "2.5096717727184297\n",
            "2.5314474630355837\n",
            "2.4976149725914003\n",
            "2.598316181898117\n",
            "2.3746532809734346\n",
            "2.519841046333313\n",
            "2.5656920194625856\n",
            "2.5018589222431182\n",
            "2.307692061662674\n",
            "2.539406018257141\n",
            "2.233166493177414\n",
            "2.6039868712425234\n",
            "2.642397656440735\n",
            "2.4397448658943177\n",
            "2.5983366560935974\n",
            "2.2630892145633696\n",
            "2.67201403260231\n",
            "2.6366231739521027\n",
            "2.458096626996994\n",
            "2.323991320133209\n",
            "2.53966813325882\n",
            "2.3019229221343993\n",
            "2.494454399347305\n",
            "2.5258606123924254\n",
            "2.6589100563526156\n",
            "2.461081076860428\n",
            "2.421746975183487\n",
            "2.4861374378204344\n",
            "2.20842896938324\n",
            "2.2865865695476533\n",
            "2.58932000875473\n",
            "2.5687098300457\n",
            "2.5324189352989195\n",
            "2.5484581279754637\n",
            "2.4107208824157715\n",
            "2.3469905829429627\n",
            "2.6189869379997255\n",
            "2.4671021473407744\n",
            "2.373452595472336\n",
            "2.3539370608329775\n",
            "2.5010709881782534\n",
            "2.606635333299637\n",
            "2.4703691601753235\n",
            "2.567838181257248\n",
            "2.5127493786811828\n",
            "2.350433691740036\n",
            "2.308958869576454\n",
            "2.265299153327942\n",
            "2.6559936702251434\n",
            "2.5937803971767424\n",
            "2.0358684968948366\n",
            "2.2005156016349794\n",
            "2.5687266218662264\n",
            "2.4211313056945802\n",
            "2.694500929117203\n",
            "2.4718406414985656\n",
            "2.4639705383777617\n",
            "2.5937296557426452\n",
            "2.6775899398326874\n",
            "2.2429548716545105\n",
            "2.4569728493690492\n",
            "2.3131690502166746\n",
            "2.145194208621979\n",
            "2.4467680168151857\n",
            "2.662459441423416\n",
            "2.5840567803382872\n",
            "2.0243545460700987\n",
            "2.334418325424194\n",
            "2.028056434392929\n",
            "2.389869735240936\n",
            "2.4815520799160002\n",
            "2.5985145699977874\n",
            "2.748765949010849\n",
            "2.476905783414841\n",
            "2.3962404000759125\n",
            "2.3442457795143126\n",
            "2.6726299464702605\n",
            "2.4625460970401765\n",
            "2.322002888917923\n",
            "2.215847067832947\n",
            "2.171548299789429\n",
            "2.2131633341312407\n",
            "2.181680643558502\n",
            "2.082524961233139\n",
            "2.1500950062274935\n",
            "2.172349579334259\n",
            "2.145229132771492\n",
            "2.225386185646057\n",
            "2.155175606012344\n",
            "2.124456980228424\n",
            "2.211115928888321\n",
            "2.152699816226959\n",
            "2.1353054320812226\n",
            "2.136871004104614\n",
            "2.2383859586715698\n",
            "2.2016532945632936\n",
            "2.20295702457428\n",
            "2.1887989437580107\n",
            "2.314106739759445\n",
            "2.164418033361435\n",
            "2.282301149368286\n",
            "2.2875188291072845\n",
            "2.2102463829517363\n",
            "2.160327718257904\n",
            "2.183268029689789\n",
            "2.204769036769867\n",
            "2.1504518151283265\n",
            "2.17787171959877\n",
            "2.224119075536728\n",
            "2.1865408658981322\n",
            "2.212720196247101\n",
            "2.242211849689484\n",
            "2.1921578812599183\n",
            "2.2314120292663575\n",
            "2.3108005011081696\n",
            "2.234361220598221\n",
            "2.2659280526638033\n",
            "2.211157318353653\n",
            "2.25999707698822\n",
            "2.2894947695732117\n",
            "2.3149729704856874\n",
            "2.2642130279541015\n",
            "2.2399172472953794\n",
            "2.2608804976940156\n",
            "2.204393218755722\n",
            "2.242954032421112\n",
            "2.2766876828670504\n",
            "2.167780052423477\n",
            "2.3020182883739473\n",
            "2.27335839509964\n",
            "2.2880116724967956\n",
            "2.303698089122772\n",
            "2.3183749175071715\n",
            "2.286913049221039\n",
            "2.22720228433609\n",
            "2.266245449781418\n",
            "2.2947625064849855\n",
            "2.3067535543441773\n",
            "2.2513031351566313\n",
            "2.302552706003189\n",
            "2.1672875571250914\n",
            "2.3311452651023865\n",
            "2.1811606991291046\n",
            "2.3208261823654173\n",
            "2.341300928592682\n",
            "2.2291391396522524\n",
            "2.2753773558139803\n",
            "2.4267448937892913\n",
            "2.2428596210479737\n",
            "2.1744565093517303\n",
            "2.28482026219368\n",
            "2.290694226026535\n",
            "2.151343151330948\n",
            "2.361996190547943\n",
            "2.35848489522934\n",
            "2.3520159983634947\n",
            "2.1733588469028473\n",
            "2.3738075244426726\n",
            "2.2087548637390135\n",
            "2.35172917842865\n",
            "2.2062057554721832\n",
            "2.2045867919921873\n",
            "2.4230792438983917\n",
            "2.1686399257183075\n",
            "2.3755413663387297\n",
            "2.2092895567417146\n",
            "2.306966508626938\n",
            "2.4156146109104157\n",
            "2.2111312842369077\n",
            "2.265627444982529\n",
            "2.2921796905994416\n",
            "2.186248940229416\n",
            "2.219577214717865\n",
            "2.574301291704178\n",
            "2.41081995844841\n",
            "2.079075372219086\n",
            "2.258618417978287\n",
            "2.401061713695526\n",
            "2.192694945335388\n",
            "2.3018976044654846\n",
            "2.5124055194854735\n",
            "2.508723216056824\n",
            "2.1634437263011934\n",
            "2.2155320620536805\n",
            "2.324679818153381\n",
            "2.4180464446544647\n",
            "2.0352763438224795\n",
            "2.3474548625946046\n",
            "2.3903634572029113\n",
            "2.3012032306194303\n",
            "2.5430956971645355\n",
            "2.1183115792274476\n",
            "2.289667851924896\n",
            "2.265646938085556\n",
            "2.5251357412338256\n",
            "2.0065217554569243\n",
            "2.1765706539154053\n",
            "2.2813605570793154\n",
            "2.5858566403388976\n",
            "2.34064343214035\n",
            "2.4424910616874693\n",
            "2.268989086151123\n",
            "2.0496645534038542\n",
            "2.296850199699402\n",
            "2.260955959558487\n",
            "2.358976536989212\n",
            "2.1918120908737184\n",
            "2.1010927867889406\n",
            "2.207973322868347\n",
            "2.3140542483329773\n",
            "2.4073536598682406\n",
            "2.351046131849289\n",
            "2.3264231413602827\n",
            "2.5854199743270874\n",
            "2.4340521764755247\n",
            "2.0146021389961244\n",
            "2.1287535655498506\n",
            "2.184143307209015\n",
            "2.241234573125839\n",
            "2.2726050329208376\n",
            "2.658910970687866\n",
            "2.406592993736267\n",
            "1.8899141347408295\n",
            "2.164081826210022\n",
            "2.1389808762073517\n",
            "2.270700739622116\n",
            "2.196254223585129\n",
            "2.282014057636261\n",
            "2.5417089474201204\n",
            "2.3898577201366424\n",
            "2.2373709964752195\n",
            "2.327724256515503\n",
            "2.3870002567768096\n",
            "2.2056927448511123\n",
            "1.9085382741689683\n",
            "2.0651851046085357\n",
            "2.158559457063675\n",
            "2.228672491312027\n",
            "2.1948186123371123\n",
            "2.1037185657024384\n",
            "2.314706372022629\n",
            "2.544195364713669\n",
            "2.3357832169532777\n",
            "1.908370041847229\n",
            "2.0716639095544815\n",
            "1.843444881439209\n",
            "2.3137085354328155\n",
            "2.207076498270035\n",
            "2.031725737452507\n",
            "2.063999579548836\n",
            "2.4636026430130005\n",
            "2.6617988741397856\n",
            "2.408434759378433\n",
            "2.182866725921631\n",
            "2.3640554535388945\n",
            "2.45828390955925\n",
            "2.4576054334640505\n",
            "2.3819437444210054\n",
            "2.348686099052429\n",
            "2.4820894491672516\n",
            "2.384163887500763\n",
            "2.4277590715885164\n",
            "2.4261870837211608\n",
            "2.374404456615448\n",
            "2.404331990480423\n",
            "2.420976836681366\n",
            "2.4260643994808198\n",
            "2.4365905857086183\n",
            "2.472901906967163\n",
            "2.449978734254837\n",
            "2.35835213303566\n",
            "2.3190633034706116\n",
            "2.3667603945732116\n",
            "2.333847074508667\n",
            "2.4018128836154937\n",
            "2.3739645779132843\n",
            "2.466659700870514\n",
            "2.379107519388199\n",
            "2.4408743715286256\n",
            "2.45825777053833\n",
            "2.4153301191329954\n",
            "2.4948842370510103\n",
            "2.3780465483665467\n",
            "2.3881080520153044\n",
            "2.473807679414749\n",
            "2.4273208248615266\n",
            "2.288905339241028\n",
            "2.393170152902603\n",
            "2.38373583316803\n",
            "2.3963238084316254\n",
            "2.385335147380829\n",
            "2.447260866165161\n",
            "2.3944678711891174\n",
            "2.4312518095970153\n",
            "2.4652680230140684\n",
            "2.4499255454540254\n",
            "2.4236188960075378\n",
            "2.551991389989853\n",
            "2.3552762973308563\n",
            "2.516331338882446\n",
            "2.4432433795928956\n",
            "2.4535869324207304\n",
            "2.41519349694252\n",
            "2.402909133434296\n",
            "2.5658989691734315\n",
            "2.544736096858978\n",
            "2.4248277151584627\n",
            "2.4822403049468993\n",
            "2.4834615850448607\n",
            "2.44134885430336\n",
            "2.449806287288666\n",
            "2.4603404211997986\n",
            "2.502595372200012\n",
            "2.4364810073375702\n",
            "2.6460122096538545\n",
            "2.4533709609508514\n",
            "2.4030843889713287\n",
            "2.555432926416397\n",
            "2.461468085050583\n",
            "2.4757011318206787\n",
            "2.4964826023578643\n",
            "2.5035187757015227\n",
            "2.5049707198143008\n",
            "2.5501920783519747\n",
            "2.5015521275997163\n",
            "2.5103421092033384\n",
            "2.4008096289634704\n",
            "2.5540148496627806\n",
            "2.467926480770111\n",
            "2.4234461963176726\n",
            "2.3346298837661745\n",
            "2.5390500664710998\n",
            "2.595899077653885\n",
            "2.564163980484009\n",
            "2.4813085293769834\n",
            "2.426253887414932\n",
            "2.5410643792152405\n",
            "2.6433825755119322\n",
            "2.6345571744441987\n",
            "2.3252487421035766\n",
            "2.510657866001129\n",
            "2.4086640870571134\n",
            "2.3279785895347596\n",
            "2.562808367013931\n",
            "2.5799432051181794\n",
            "2.60312783241272\n",
            "2.3128082871437075\n",
            "2.4210775327682494\n",
            "2.3549175691604614\n",
            "2.1876478099823\n",
            "2.4877540493011474\n",
            "2.6354582107067106\n",
            "2.4968211686611177\n",
            "2.7387805938720704\n",
            "2.3684558033943177\n",
            "2.3817304480075836\n",
            "2.4065401935577393\n",
            "2.712526807785034\n",
            "2.3496558976173403\n",
            "2.2734549975395204\n",
            "2.4698850882053374\n",
            "2.7123063623905184\n",
            "2.390497716665268\n",
            "2.5059681904315947\n",
            "2.593131251335144\n",
            "2.3584259951114657\n",
            "2.3745749771595\n",
            "2.328654184341431\n",
            "2.439614979028702\n",
            "2.691293808221817\n",
            "2.2169687902927397\n",
            "2.3617835128307343\n",
            "2.3419313871860505\n",
            "2.3621522903442385\n",
            "2.7298838472366334\n",
            "2.498220053911209\n",
            "2.4192787969112395\n",
            "2.7256825292110443\n",
            "2.6052739787101746\n",
            "2.292554807662964\n",
            "2.455739439725876\n",
            "2.2772485435009004\n",
            "2.2730833148956298\n",
            "2.3575805479288103\n",
            "2.6278836035728457\n",
            "2.5857260644435884\n",
            "2.1442564594745637\n",
            "2.2587465155124664\n",
            "2.2305886435508726\n",
            "2.3293366676568983\n",
            "2.489628714323044\n",
            "2.618085763454437\n",
            "2.7116219460964204\n",
            "2.420175211429596\n",
            "2.4528795528411864\n",
            "2.337061171531677\n",
            "2.7419472408294676\n"
          ]
        }
      ],
      "source": [
        "total_loss = 0\n",
        "total_ct = 0\n",
        "total_epochs = 5\n",
        "\n",
        "for _ in range(total_epochs):\n",
        "    for name in open('/content/names-1.txt', 'r'):\n",
        "        # Lowercase and get rid of new lines and spaces at the end\n",
        "        name = name.strip().lower()\n",
        "        # Add the START and END padding token\n",
        "        name = '.' + name + '.'\n",
        "\n",
        "        # Get x_data, which is names[:-1]\n",
        "        # Get y_data, which is names[1:]\n",
        "        x_data = torch.tensor([stoi[char] for char in name[:-1]], dtype=torch.long)\n",
        "        y_data = torch.tensor([stoi[char] for char in name[1:]], dtype=torch.long)\n",
        "\n",
        "        # Set the list of all logits\n",
        "        logits = []\n",
        "\n",
        "        # Reset gradients\n",
        "        optimizer.zero_grad()\n",
        "\n",
        "        # Set the hidden state to random\n",
        "        # (1, d_h)\n",
        "        h_past = [torch.randn(1, d_h)]\n",
        "\n",
        "        # Go through each token of a word and get the logits\n",
        "        for i, x in enumerate(x_data):\n",
        "            x = torch.tensor([x])\n",
        "            z, h_past = model(x, h_past)\n",
        "            logits.append(z)\n",
        "\n",
        "        # Concatenate all the logits\n",
        "        logits = torch.cat(logits, dim=0)\n",
        "\n",
        "        # Compute the loss\n",
        "        loss = F.cross_entropy(logits, y_data)\n",
        "\n",
        "        # Get the new gradient\n",
        "        loss.backward()\n",
        "\n",
        "        # Clip the gradients at max norm 0.1\n",
        "        nn.utils.clip_grad_norm_(model.parameters(), max_norm=0.1)\n",
        "\n",
        "        # Do a gradient update\n",
        "        optimizer.step()\n",
        "\n",
        "        # Get the loss for the batch and get the number of batches\n",
        "        total_loss += loss.item()\n",
        "        total_ct += 1\n",
        "\n",
        "        if total_ct and total_ct % 100 == 0:\n",
        "            print(total_loss / total_ct)\n",
        "            total_loss = 0\n",
        "            total_ct = 0\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "c4ef8288",
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "c4ef8288",
        "outputId": "b2099f04-df9f-4178-beb9-c46e05edc8be"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "<ipython-input-52-0d9e4e61c830>:25: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).\n",
            "  x = torch.tensor(x)\n",
            "<ipython-input-52-0d9e4e61c830>:33: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).\n",
            "  loss = F.cross_entropy(logits, torch.tensor(y_data), reduction='sum')\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Perplexity:  18.1744375201569\n"
          ]
        }
      ],
      "source": [
        "with torch.no_grad():\n",
        "    # Get perplexity\n",
        "    sumneglogp = 0\n",
        "    T = 0\n",
        "    for name in open('/content/names-1.txt', 'r'):\n",
        "        name = name.lower().strip()\n",
        "        T += len(name) + 1\n",
        "        # Pad with START and STOP\n",
        "        name = '.' + name + '.'\n",
        "        # Get the name from index 0 to -1 exclusive end\n",
        "        x_data = torch.tensor([stoi[char] for char in name[:-1]], dtype=torch.long)\n",
        "        # Get the y from index 1 to end inclusive end\n",
        "        y_data = torch.tensor([stoi[char] for char in name[1:]], dtype=torch.long)\n",
        "\n",
        "        # Define the logits per token prediction\n",
        "        logits = []\n",
        "\n",
        "        # Initialize the h vector to random\n",
        "        h_past = [torch.randn(1, d_h)]\n",
        "\n",
        "        # Loop over each chracter in the name and pass h and this into the RNN\n",
        "        # Get the new logit\n",
        "        for x in x_data:\n",
        "            # x_data above was raw; get the int representation if you also do that\n",
        "            x = torch.tensor(x)\n",
        "            z, h_past = model(x, h_past)\n",
        "            # Append the logit\n",
        "            logits.append(z)\n",
        "\n",
        "        logits = torch.cat(logits, dim=0)\n",
        "\n",
        "        # Compute the loss\n",
        "        loss = F.cross_entropy(logits, torch.tensor(y_data), reduction='sum')\n",
        "\n",
        "        # Change to log base 2\n",
        "        # log2(x) = ln(x) / ln(2)\n",
        "        loss *= (1 / math.log(2))\n",
        "\n",
        "        sumneglogp += loss.item()\n",
        "\n",
        "    # sumneglogp is -log(p('.' + name1)) -log(p('.' + name2)) -log(p('.' + name3)) ...\n",
        "    # Divide by the appropriate term to get the answer we want\n",
        "    perp = 2 ** (sumneglogp / T)\n",
        "    print('Perplexity: ', perp)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "4ce739fc",
      "metadata": {
        "id": "4ce739fc",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "2380c9ce-098b-4657-8ff5-47f5c4c49fba"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Generated name:  hselvmjyljbahv\n"
          ]
        }
      ],
      "source": [
        "# Generate a random word using this distributon\n",
        "# Intialize the word with\n",
        "name = '.'\n",
        "# Set this to [h_0]\n",
        "h_past = [torch.randn(1, d_h)]\n",
        "while True:\n",
        "    # Get the last character in the name\n",
        "    c = name[-1]\n",
        "    # Make the distribution from c to any other word other than START\n",
        "    logits, h_past = model(torch.tensor([stoi[c]]), h_past)\n",
        "    # Get the probabilities\n",
        "    p = torch.softmax(logits, dim=0)\n",
        "    # Sample a character from th distribution above\n",
        "    c = torch.multinomial(p, num_samples=1)\n",
        "\n",
        "    # Halt generation if the token gotten is '.' or append the new token to the name\n",
        "    if itos[c.item()] == '.':\n",
        "        break\n",
        "    else:\n",
        "        name += itos[c.item()]\n",
        "print('Generated name: ' , name[1:])"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "818b1446",
      "metadata": {
        "id": "818b1446"
      },
      "outputs": [],
      "source": []
    },
    {
      "cell_type": "markdown",
      "id": "f1bb8bbf",
      "metadata": {
        "id": "f1bb8bbf"
      },
      "source": [
        "## Gated CNN\n",
        "- Implement a language model across names similar to that here: https://arxiv.org/abs/1612.08083v3\n",
        "- Batch size will be 1\n",
        "- For a name like \"abcdef\" we will use data [.abcdef] -> [abcdef.]\n",
        "- '.' is a start and end token, which denotes either the start or end of a word"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 72,
      "id": "fb20d666",
      "metadata": {
        "id": "fb20d666"
      },
      "outputs": [],
      "source": [
        "class GatedCNNLanguageModel(nn.Module):\n",
        "    def __init__(self, n_layers, kernel_size):\n",
        "        super().__init__()\n",
        "\n",
        "        # Define an embedding layer so each character gets an embedding of size d_model\n",
        "        # There are vocab_size tokens\n",
        "        self.e = nn.Embedding(vocab_size, d_model)\n",
        "\n",
        "        # Define n_layers\n",
        "        self.n_layers = n_layers\n",
        "\n",
        "        # Define A as the first Conv1d layer which takes in d_model returns d_model and uses kernel_size kernels\n",
        "        self.A = nn.Conv1d(in_channels=d_model, out_channels=d_model, kernel_size=kernel_size, padding=0)\n",
        "\n",
        "        # Define B as the first Conv1d layer which takes in d_model returns d_model and uses kernel_size kernels\n",
        "        self.B = nn.Conv1d(in_channels=d_model, out_channels=d_model, kernel_size=kernel_size, padding=0)\n",
        "\n",
        "        # Define a list of A layers as above; n_layers\n",
        "        self.A_list = nn.ModuleList([nn.Conv1d(d_model, d_model, kernel_size, padding=0) for _ in range(n_layers)])\n",
        "\n",
        "        # Define a list of B layers as above; n_layers\n",
        "        self.B_list = nn.ModuleList([nn.Conv1d(d_model, d_model, kernel_size, padding=0) for _ in range(n_layers)])\n",
        "\n",
        "        # Define a fully connected layer which takes d_model embedding and gives the logits across vocab_size tokens\n",
        "        self.fc = nn.Linear(d_model, vocab_size)\n",
        "\n",
        "        # Pad on the left with an amount such that the input is the same dimension as the output\n",
        "        # Remember, our data looks like [a, b, c] -> [b, c, d]\n",
        "        # We want to make sure tokens to the left of b (a) are used to predict b\n",
        "        # We want to make sure tokens to the left of c (a, b) are used to predict c\n",
        "        # We want to make sure tokens to the left of d (a, b, c) are used to predict d\n",
        "        # Etc.\n",
        "        # Pad with on the left\n",
        "        self.padding = nn.ConstantPad1d((kernel_size - 1, 0), 0)\n",
        "\n",
        "    def forward(self, x):\n",
        "        # Run through to get the embedding for the token\n",
        "        # The embedding per token is the feature vector x  we pass into the\n",
        "        # (B, L, D)\n",
        "        x = self.e(x)\n",
        "\n",
        "        # Change the above to be (B, D, L)\n",
        "        x = x.transpose(1, 2)\n",
        "\n",
        "        # Pad on the left with the right amount\n",
        "        # Remember, what goes in, need to come out the same dimension and you can't \"look ahead\"\n",
        "        # You want to just pad on the left\n",
        "        # (B, D, L + kernel_size - 1)\n",
        "        x = self.padding(x)\n",
        "\n",
        "        # Run x through A, B and get h as defined for the gated CNN\n",
        "        # Define the res_input as the hidden layer we get; we'll move forward with h\n",
        "        h = self.A(x) * torch.sigmoid(self.B(x))\n",
        "        res_input = h\n",
        "\n",
        "        for i, (conv, conv_gate) in enumerate(zip(self.A_list, self.B_list)):\n",
        "            # Pad on the left\n",
        "            h = self.padding(h)\n",
        "            # Apply conv and conv_gate to h and then combine to get the new h\n",
        "            # Get the new h, and also add to it the old non transformed hidden layer; the residual connection\n",
        "            outcome = torch.sigmoid(conv_gate(h))\n",
        "            h = conv(h) * outcome\n",
        "            h = h + res_input\n",
        "            # Reset the residual so you use it next time\n",
        "            res_input = h\n",
        "\n",
        "        # Get the final h to be of dimension (B, L, D)\n",
        "        h = h.transpose(1, 2)\n",
        "\n",
        "        # Get the logits which is of dimension (B, L, vocab_size)\n",
        "        logit = self.fc(h)\n",
        "\n",
        "        # Transpose the logits to be of dimension (B, vocab_size, L)\n",
        "        logit = logit.transpose(1, 2)\n",
        "        return logit"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 73,
      "id": "a545c762",
      "metadata": {
        "id": "a545c762"
      },
      "outputs": [],
      "source": [
        "n_layers = 3\n",
        "kernel_size = 3\n",
        "model = GatedCNNLanguageModel(n_layers, kernel_size)\n",
        "optimizer = torch.optim.Adam(model.parameters(), lr=1e-3)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 74,
      "id": "6a94272e",
      "metadata": {
        "id": "6a94272e",
        "outputId": "c3f502dc-d43c-475b-fbd6-e355c8e5bf84",
        "colab": {
          "base_uri": "https://localhost:8080/"
        }
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "3.29078950881958\n",
            "3.2200179362297057\n",
            "3.1113421654701234\n",
            "3.0078507399559022\n",
            "2.9357504057884216\n",
            "2.844966286420822\n",
            "2.796919097900391\n",
            "2.755930666923523\n",
            "2.750299036502838\n",
            "2.6953082942962645\n",
            "2.725448567867279\n",
            "2.6710942602157592\n",
            "2.6701448547840116\n",
            "2.625736476182938\n",
            "2.6208910536766052\n",
            "2.5328429210186005\n",
            "2.5620501589775087\n",
            "2.5545638000965116\n",
            "2.597511236667633\n",
            "2.5051258420944214\n",
            "2.5295876348018647\n",
            "2.482521188259125\n",
            "2.5105024921894072\n",
            "2.539478943347931\n",
            "2.5354833781719206\n",
            "2.4484115052223205\n",
            "2.499486504793167\n",
            "2.459040570259094\n",
            "2.455652961730957\n",
            "2.477422310113907\n",
            "2.4257937932014464\n",
            "2.376577842235565\n",
            "2.3600461900234224\n",
            "2.3791255939006803\n",
            "2.4151888394355776\n",
            "2.312710461616516\n",
            "2.360325781106949\n",
            "2.4330976009368896\n",
            "2.374376242160797\n",
            "2.3986418223381043\n",
            "2.392200891971588\n",
            "2.452049161195755\n",
            "2.3367424714565277\n",
            "2.3918819439411165\n",
            "2.4245585918426515\n",
            "2.393138437271118\n",
            "2.380237376689911\n",
            "2.3738956582546233\n",
            "2.351949486732483\n",
            "2.3080760610103606\n",
            "2.3496448838710786\n",
            "2.369456744194031\n",
            "2.291222805976868\n",
            "2.457118272781372\n",
            "2.327318388223648\n",
            "2.343268644809723\n",
            "2.2896239507198333\n",
            "2.368111437559128\n",
            "2.268433301448822\n",
            "2.343508437871933\n",
            "2.4007355189323425\n",
            "2.4159954130649566\n",
            "2.342575658559799\n",
            "2.2499527037143707\n",
            "2.3811508941650392\n",
            "2.44722550034523\n",
            "2.3437535011768342\n",
            "2.3136916756629944\n",
            "2.3578568613529205\n",
            "2.3336565244197844\n",
            "2.2621178275346754\n",
            "2.392025130987167\n",
            "2.2698030936717988\n",
            "2.2887110924720764\n",
            "2.3651571822166444\n",
            "2.227475266456604\n",
            "2.5189957332611086\n",
            "2.3301332330703737\n",
            "2.3328198981285095\n",
            "2.183178058862686\n",
            "2.4389606606960297\n",
            "2.2742099964618685\n",
            "2.3739367294311524\n",
            "2.231498545408249\n",
            "2.4049242520332337\n",
            "2.28864297747612\n",
            "2.313752784729004\n",
            "2.3876864278316496\n",
            "2.2393944346904755\n",
            "2.2793340933322908\n",
            "2.4265958201885223\n",
            "2.1305579674243926\n",
            "2.3284334218502045\n",
            "2.357176345586777\n",
            "2.2142054545879364\n",
            "2.297465204000473\n",
            "2.457584764957428\n",
            "2.227732399702072\n",
            "2.34404648065567\n",
            "2.3307271790504456\n",
            "2.490209698677063\n",
            "2.2035036909580232\n",
            "2.1813382387161253\n",
            "2.4860242187976835\n",
            "2.431815901994705\n",
            "2.1067529809474945\n",
            "2.421850082874298\n",
            "2.3167564916610717\n",
            "2.3563904881477358\n",
            "2.247060836553574\n",
            "2.1049353814125062\n",
            "2.432039359807968\n",
            "2.4578549349308014\n",
            "2.2332058787345885\n",
            "2.155846576690674\n",
            "2.4036338901519776\n",
            "2.297855565547943\n",
            "2.429826444387436\n",
            "2.271297993659973\n",
            "2.135690931081772\n",
            "2.1052491700649263\n",
            "2.515489985942841\n",
            "2.4937153279781343\n",
            "2.2585013937950134\n",
            "2.067651653289795\n",
            "2.162968945503235\n",
            "2.4895736706256866\n",
            "2.1135835909843443\n",
            "2.4318402826786043\n",
            "2.2416936284303666\n",
            "2.147274292707443\n",
            "2.2622004067897796\n",
            "2.130879112482071\n",
            "2.335123846530914\n",
            "2.297238645553589\n",
            "2.4886305534839632\n",
            "2.439504700899124\n",
            "2.0515215408802034\n",
            "2.215227690935135\n",
            "2.2413134956359864\n",
            "2.472109967470169\n",
            "2.2544825577735903\n",
            "2.1508211517333984\n",
            "2.549140033721924\n",
            "2.250347965955734\n",
            "2.270327455997467\n",
            "2.1612267446517945\n",
            "2.3273089694976807\n",
            "2.1917213690280914\n",
            "2.1820348489284513\n",
            "2.2560246443748473\n",
            "2.495142045021057\n",
            "2.326329752802849\n",
            "2.4086701893806457\n",
            "2.3542527413368224\n",
            "2.2275584959983825\n",
            "2.0973852920532225\n",
            "2.078529055118561\n",
            "2.175610340833664\n",
            "2.3058878314495086\n",
            "2.4508866333961485\n",
            "2.274166909456253\n",
            "2.181203249692917\n",
            "2.2555926179885866\n",
            "2.548860800266266\n",
            "2.290031988620758\n",
            "2.3244205832481386\n",
            "2.1677026200294494\n",
            "2.25781569480896\n",
            "2.088396962881088\n",
            "2.153751267194748\n",
            "2.0102963244915006\n",
            "2.11730652153492\n",
            "2.2930662977695464\n",
            "2.4626723492145537\n",
            "2.4506432473659516\n",
            "2.3726448237895967\n",
            "2.3410261356830597\n",
            "2.4905089151859285\n",
            "2.3181781446933747\n",
            "2.435328370332718\n",
            "2.466236937046051\n",
            "2.361998101472855\n",
            "2.3461468386650086\n",
            "2.3978149628639223\n",
            "2.3072142457962035\n",
            "2.3230397546291353\n",
            "2.4404512989521026\n",
            "2.2843197798728943\n",
            "2.3803061312437057\n",
            "2.3276735293865203\n",
            "2.3422613859176638\n",
            "2.354867181777954\n",
            "2.32811644077301\n",
            "2.3259167873859408\n",
            "2.312409064769745\n",
            "2.2062054669857023\n",
            "2.3152040112018586\n",
            "2.2532031708955764\n",
            "2.425992110967636\n",
            "2.3019035094976426\n",
            "2.2835205435752868\n",
            "2.2518701791763305\n",
            "2.3908313751220702\n",
            "2.2595325219631195\n",
            "2.2310905611515044\n",
            "2.2732004415988922\n",
            "2.2863865768909455\n",
            "2.3214556121826173\n",
            "2.146833811998367\n",
            "2.2728565633296967\n",
            "2.2653628790378573\n",
            "2.30809929728508\n",
            "2.290677114725113\n",
            "2.309759043455124\n",
            "2.3180079996585845\n",
            "2.3176612055301664\n",
            "2.282826964855194\n",
            "2.2874428153038027\n",
            "2.3013055062294008\n",
            "2.320371344089508\n",
            "2.3444513303041457\n",
            "2.248161727786064\n",
            "2.301452600955963\n",
            "2.3714209532737733\n",
            "2.2871363788843153\n",
            "2.331548248529434\n",
            "2.3892609095573425\n",
            "2.4039353561401366\n",
            "2.237858691215515\n",
            "2.3524962782859804\n",
            "2.2618959939479826\n",
            "2.264051761627197\n",
            "2.320553147792816\n",
            "2.2238119316101073\n",
            "2.3650628983974458\n",
            "2.3462556380033495\n",
            "2.4244415807724\n",
            "2.394999396800995\n",
            "2.244532655477524\n",
            "2.303101079463959\n",
            "2.302065533399582\n",
            "2.4031949818134306\n",
            "2.2804051995277406\n",
            "2.3658664202690125\n",
            "2.2803692603111267\n",
            "2.477154470682144\n",
            "2.318935503959656\n",
            "2.325304996967316\n",
            "2.255252652168274\n",
            "2.346510878801346\n",
            "2.246437960267067\n",
            "2.4139035296440126\n",
            "2.333482691049576\n",
            "2.2861256980895996\n",
            "2.4727877199649813\n",
            "2.19553998708725\n",
            "2.306533164978027\n",
            "2.234831151366234\n",
            "2.297185560464859\n",
            "2.5491641438007355\n",
            "2.3320365738868714\n",
            "2.340915386080742\n",
            "2.2866478180885315\n",
            "2.1614806973934173\n",
            "2.3512436759471895\n",
            "2.332350218296051\n",
            "2.513104358911514\n",
            "2.2465676212310792\n",
            "2.4246900725364684\n",
            "2.266928038597107\n",
            "2.232685205936432\n",
            "2.1828090035915375\n",
            "2.2680011594295504\n",
            "2.3808502674102785\n",
            "2.4844245278835295\n",
            "2.2578324556350706\n",
            "2.285352586507797\n",
            "2.3859502398967742\n",
            "2.292259711027145\n",
            "2.340220867395401\n",
            "2.3489854240417483\n",
            "2.3070563566684723\n",
            "2.195918211340904\n",
            "2.4709234058856966\n",
            "2.4141501820087434\n",
            "2.4804464197158813\n",
            "2.3080263417959213\n",
            "2.238003741502762\n",
            "2.4977312052249907\n",
            "2.2473800706863405\n",
            "2.1983186906576155\n",
            "2.43278963804245\n",
            "2.2985283482074736\n",
            "2.1242202842235565\n",
            "2.2050847029685974\n",
            "2.0367838674783707\n",
            "2.465999927520752\n",
            "2.4327777814865112\n",
            "2.4493253946304323\n",
            "2.4410025835037232\n",
            "2.349401710033417\n",
            "2.139879336357117\n",
            "2.384120787382126\n",
            "2.369027637243271\n",
            "2.1930000483989716\n",
            "2.2928673684597016\n",
            "2.2844513499736787\n",
            "2.454408013820648\n",
            "2.18097589969635\n",
            "2.2627792525291444\n",
            "2.152198860645294\n",
            "2.2869658744335175\n",
            "2.1516820776462553\n",
            "2.3385761475563047\n",
            "2.4598500728607178\n",
            "2.311354864835739\n",
            "2.5115534830093384\n",
            "2.3702440094947814\n",
            "2.354035860300064\n",
            "2.319961801767349\n",
            "2.1550521886348726\n",
            "2.1547823536396025\n",
            "2.1428036218881608\n",
            "2.1754108464717863\n",
            "2.12165387570858\n",
            "1.9870472860336303\n",
            "2.006648656129837\n",
            "2.0539479672908785\n",
            "2.1657067918777466\n",
            "2.1131981652975083\n",
            "2.1542548173666\n",
            "2.05530420422554\n",
            "2.2165492153167725\n",
            "2.162748015522957\n",
            "2.1017480862140654\n",
            "2.040881205201149\n",
            "2.1325993978977205\n",
            "2.1649027955532074\n",
            "2.136125446557999\n",
            "2.073065836429596\n",
            "2.1803326731920243\n",
            "2.119429134130478\n",
            "2.1464507931470873\n",
            "2.2113803958892824\n",
            "2.1284749042987823\n",
            "2.0785137951374053\n",
            "2.117482687830925\n",
            "2.1554218876361846\n",
            "2.170369562506676\n",
            "2.094712189435959\n",
            "2.0836393159627913\n",
            "1.9387545257806778\n",
            "2.0503634774684905\n",
            "2.0767717024683954\n",
            "1.985977218747139\n",
            "2.025367970466614\n",
            "2.1737942200899125\n",
            "2.169342043995857\n",
            "2.116388441324234\n",
            "2.0941211026906967\n",
            "2.2249771511554717\n",
            "2.0453237080574036\n",
            "2.136821051836014\n",
            "2.1357431572675707\n",
            "2.133894466161728\n",
            "2.090305392742157\n",
            "2.0745584607124328\n",
            "2.084730786085129\n",
            "2.023102742433548\n",
            "2.035618540048599\n",
            "2.1205327093601225\n",
            "2.1144543367624284\n",
            "2.1827245318889616\n",
            "2.037936115860939\n",
            "2.174322052001953\n",
            "2.0624904370307924\n",
            "2.0307356238365175\n",
            "2.0901508820056915\n",
            "2.0906485724449158\n",
            "2.132848098278046\n",
            "2.179855624437332\n",
            "2.1508126348257064\n",
            "2.139747042655945\n",
            "1.9803652292490006\n",
            "2.086255040168762\n",
            "2.1830449801683427\n",
            "2.136109166741371\n",
            "2.075691652297974\n",
            "2.114675859808922\n",
            "2.10707677423954\n",
            "2.1751863032579424\n",
            "2.0123885715007783\n",
            "2.0796960735321046\n",
            "2.27109358727932\n",
            "2.0785061854124067\n",
            "2.1976304805278777\n",
            "2.09549293756485\n",
            "2.1693317246437074\n",
            "2.051070035099983\n",
            "2.191582591533661\n",
            "2.0602501964569093\n",
            "2.169670038819313\n",
            "2.1847009325027464\n",
            "1.9970266538858414\n",
            "2.1376281663775445\n",
            "2.1127804571390154\n",
            "2.0960747665166855\n",
            "2.171610059142113\n",
            "1.9402890753746034\n",
            "2.2991827178001403\n",
            "1.8913806068897248\n",
            "2.2269012981653216\n",
            "2.132590116262436\n",
            "2.1240803849697114\n",
            "1.9582741743326186\n",
            "2.2980779647827148\n",
            "2.2184497904777527\n",
            "2.020911518931389\n",
            "2.179441632628441\n",
            "2.214650148153305\n",
            "2.203410917520523\n",
            "1.9986118048429489\n",
            "2.2476624238491056\n",
            "2.288339146375656\n",
            "2.007235949635506\n",
            "2.1378390181064604\n",
            "2.1355683970451356\n",
            "2.2025383710861206\n",
            "2.115623403787613\n",
            "2.03591576397419\n",
            "2.0996231067180635\n",
            "2.332746734619141\n",
            "2.233383057117462\n",
            "1.9291532373428344\n",
            "2.2611565667390825\n",
            "2.0596174073219298\n",
            "2.242818595170975\n",
            "2.162183523774147\n",
            "1.9749238246679306\n",
            "1.97173370718956\n",
            "2.231111387014389\n",
            "2.282388323545456\n",
            "2.2357462561130523\n",
            "1.908426775932312\n",
            "2.062065569162369\n",
            "2.2544892519712447\n",
            "2.093133455514908\n",
            "2.1185681581497193\n",
            "2.087835142612457\n",
            "2.1402360188961027\n",
            "2.1333497285842897\n",
            "2.05206722676754\n",
            "2.046788375377655\n",
            "2.2157288539409636\n",
            "2.2498535031080245\n",
            "2.3178558361530306\n",
            "2.0870431143045427\n",
            "2.093582208752632\n",
            "1.94414647936821\n",
            "2.2800529289245604\n",
            "2.3319175601005555\n",
            "1.9275863587856292\n",
            "2.356178891658783\n",
            "2.1972344768047334\n",
            "2.1581219923496247\n",
            "2.0653819078207016\n",
            "2.293083294630051\n",
            "2.0145718574523928\n",
            "2.0299981492757797\n",
            "2.0209662640094757\n",
            "2.3469736623764037\n",
            "2.2908377677202223\n",
            "2.18400276184082\n",
            "2.18533069729805\n",
            "2.1833402132987976\n",
            "2.009414660334587\n",
            "1.8477676141262054\n",
            "2.1496078604459763\n",
            "2.066125060915947\n",
            "2.3720645928382873\n",
            "2.276081745624542\n",
            "2.0500223326683042\n",
            "2.11305092394352\n",
            "2.378565465211868\n",
            "2.227684807181358\n",
            "2.2207720029354094\n",
            "2.0749591851234435\n",
            "2.1017257153987883\n",
            "2.097069251537323\n",
            "1.9938114923238754\n",
            "2.0022767114639284\n",
            "1.8834602797031403\n",
            "2.1174136531352996\n",
            "2.354650114774704\n",
            "2.401762104034424\n",
            "2.2180584859848023\n",
            "2.239809286594391\n",
            "2.2893692898750304\n",
            "2.284109592437744\n",
            "2.2686253774166105\n",
            "2.296159682273865\n",
            "2.334227331876755\n",
            "2.2355829095840454\n",
            "2.233001445531845\n",
            "2.265799922347069\n",
            "2.1541685634851455\n",
            "2.2721461355686188\n",
            "2.2784655368328095\n",
            "2.1911069518327713\n",
            "2.2448460602760316\n",
            "2.2437441825866697\n",
            "2.2391302180290222\n",
            "2.213552333712578\n",
            "2.2455989158153535\n",
            "2.211932173371315\n",
            "2.118044377565384\n",
            "2.1125722515583036\n",
            "2.2472026520967483\n",
            "2.2891480338573458\n",
            "2.1517385703325274\n",
            "2.2447050017118455\n",
            "2.175629699230194\n",
            "2.242565698623657\n",
            "2.210567266345024\n",
            "2.1242284214496614\n",
            "2.2199845844507218\n",
            "2.1831491732597352\n",
            "2.192983765602112\n",
            "2.0386167323589324\n",
            "2.1967990452051165\n",
            "2.133861006498337\n",
            "2.200399261713028\n",
            "2.2477102947235106\n",
            "2.272993788123131\n",
            "2.153001186847687\n",
            "2.2503980338573455\n",
            "2.1941084748506547\n",
            "2.154827762246132\n",
            "2.229188486337662\n",
            "2.241953744888306\n",
            "2.266764487028122\n",
            "2.173389570116997\n",
            "2.1702020210027695\n",
            "2.3031539487838746\n",
            "2.2204273998737336\n",
            "2.2852185559272766\n",
            "2.2773799049854277\n",
            "2.278651987314224\n",
            "2.251476050615311\n",
            "2.22507949590683\n",
            "2.2248025554418565\n",
            "2.0793696945905684\n",
            "2.3383468931913374\n",
            "2.047236224114895\n",
            "2.2996640491485594\n",
            "2.319426645040512\n",
            "2.3688121998310088\n",
            "2.2527286219596863\n",
            "2.1617885822057725\n",
            "2.199202434420586\n",
            "2.269497357606888\n",
            "2.232219444513321\n",
            "2.334673008918762\n",
            "2.239668558239937\n",
            "2.283570622205734\n",
            "2.301927593946457\n",
            "2.286643858551979\n",
            "2.2982254183292388\n",
            "2.208872231245041\n",
            "2.2375406765937806\n",
            "2.1941619980335236\n",
            "2.3260779047012328\n",
            "2.25978846013546\n",
            "2.292855581045151\n",
            "2.3673848688602446\n",
            "2.159466625452042\n",
            "2.1785732370615007\n",
            "2.2058031392097472\n",
            "2.108650279045105\n",
            "2.4417028152942657\n",
            "2.4476412069797515\n",
            "2.2479449021816253\n",
            "2.170823574066162\n",
            "2.1950565564632414\n",
            "2.1476594853401183\n",
            "2.2491427063941956\n",
            "2.4676350569725036\n",
            "2.209948180913925\n",
            "2.283750731945038\n",
            "2.22508740067482\n",
            "2.183576990365982\n",
            "2.1497865319252014\n",
            "2.188631150722504\n",
            "2.3107044506073\n",
            "2.400157445669174\n",
            "2.318413766026497\n",
            "2.041603926420212\n",
            "2.392056750059128\n",
            "2.1817605119943617\n",
            "2.377285019159317\n",
            "2.2937911456823348\n",
            "2.2261751925945283\n",
            "2.05308142721653\n",
            "2.4972041761875152\n",
            "2.3197504699230196\n",
            "2.3784884095191954\n",
            "2.3265205305814742\n",
            "2.164049285650253\n",
            "2.297771525382996\n",
            "2.3270752668380736\n",
            "2.12078387260437\n",
            "2.391721171140671\n",
            "2.158297124505043\n",
            "2.1658031874895096\n",
            "2.2981246548891066\n",
            "1.8776486164331436\n",
            "2.3645851278305052\n",
            "2.243757655620575\n",
            "2.4429885649681093\n",
            "2.4391170728206633\n",
            "2.3374460196495055\n",
            "2.1446738708019257\n",
            "2.1549716883897783\n",
            "2.266051312685013\n",
            "2.2627165591716767\n",
            "2.2293052196502687\n",
            "2.2649555587768555\n",
            "2.259732614159584\n",
            "2.159410538673401\n",
            "2.348492081165314\n",
            "1.9428104680776597\n",
            "2.3397342801094054\n",
            "2.091569291353226\n",
            "2.14835009932518\n",
            "2.3343675339221956\n",
            "2.2975951266288757\n",
            "2.4137660801410674\n",
            "2.3157130670547486\n",
            "2.3455248832702638\n",
            "2.255687335729599\n",
            "2.116401084661484\n",
            "2.079052050113678\n",
            "2.0376085907220842\n",
            "2.1592645037174223\n",
            "2.0846457010507584\n",
            "1.9076112285256386\n",
            "1.9256485652923585\n",
            "1.9247864437103273\n",
            "2.14105210006237\n",
            "2.0433310946822165\n",
            "2.015524315237999\n",
            "2.0352008521556852\n",
            "2.138620471954346\n",
            "2.110126832127571\n",
            "2.055325073897839\n",
            "1.9691211557388306\n",
            "2.1341632097959518\n",
            "1.969821656048298\n",
            "2.1052774399518968\n",
            "2.0165242236852645\n",
            "2.10967435836792\n",
            "2.096133301258087\n",
            "2.067643842101097\n",
            "2.1479979336261747\n",
            "2.0571072560548784\n",
            "1.9831517034769057\n",
            "2.079725269675255\n",
            "2.0807652518153192\n",
            "2.133890386223793\n",
            "2.0605338555574417\n",
            "1.9564556622505187\n",
            "1.8985070115327836\n",
            "1.9928633439540864\n",
            "2.0817003518342974\n",
            "1.9019516310095788\n",
            "1.9252144080400466\n",
            "2.1569957464933394\n",
            "2.0669012129306794\n",
            "2.0563997620344163\n",
            "2.102335816323757\n",
            "2.0803352123498917\n",
            "2.034822831749916\n",
            "2.0475792324543\n",
            "2.0976552164554594\n",
            "2.0807400155067444\n",
            "1.9985789889097214\n",
            "2.008068407177925\n",
            "2.1033733117580415\n",
            "1.8544230419397354\n",
            "2.087808538079262\n",
            "1.98359430372715\n",
            "2.047301544547081\n",
            "2.084642037153244\n",
            "2.0397690385580063\n",
            "2.12019470512867\n",
            "1.9995537769794465\n",
            "2.0360859233140944\n",
            "2.016855006814003\n",
            "1.9657711720466613\n",
            "2.1158643469214438\n",
            "2.086333710551262\n",
            "2.0866210639476774\n",
            "2.14789659678936\n",
            "1.8984618830680846\n",
            "1.9904302561283111\n",
            "2.1538232338428496\n",
            "2.159198269844055\n",
            "1.9860544359683991\n",
            "1.9691828539967537\n",
            "2.1258649730682375\n",
            "2.1063545960187913\n",
            "2.0413981968164445\n",
            "2.0088177412748336\n",
            "2.078987411260605\n",
            "2.049603173136711\n",
            "2.110109650492668\n",
            "2.1038904005289076\n",
            "2.0954556918144225\n",
            "2.1047606760263444\n",
            "2.0106550526618956\n",
            "2.0981629741191865\n",
            "2.002976823449135\n",
            "2.2785334295034407\n",
            "1.8755178475379943\n",
            "2.1717507183551787\n",
            "1.9068608224391936\n",
            "2.0290553659200667\n",
            "2.204873629808426\n",
            "1.8946708738803864\n",
            "2.2153093314170835\n",
            "1.9440823981165887\n",
            "2.1709402704238894\n",
            "2.051424396634102\n",
            "2.1578772193193436\n",
            "1.9158879828453064\n",
            "2.1384113997220995\n",
            "2.2266396844387053\n",
            "2.01079352915287\n",
            "2.0873770654201507\n",
            "2.207025660872459\n",
            "2.07794054210186\n",
            "2.0133990943431854\n",
            "2.0030116909742355\n",
            "2.354849078655243\n",
            "2.0070648205280306\n",
            "2.0520009768009184\n",
            "2.1457559090852736\n",
            "2.1205671155452728\n",
            "2.0464725148677827\n",
            "2.0404711133241653\n",
            "1.9635968124866485\n",
            "2.2468155038356783\n",
            "2.243681788444519\n",
            "1.9454010868072509\n",
            "2.0520512568950653\n",
            "2.208924419879913\n",
            "2.131549205183983\n",
            "2.0922225058078765\n",
            "2.0767507833242416\n",
            "1.9168184220790863\n",
            "1.9206368547677994\n",
            "2.4056441581249235\n",
            "2.1903927975893023\n",
            "1.9327065187692642\n",
            "1.9946188586950302\n",
            "2.1637293833494184\n",
            "2.1141546154022217\n",
            "1.950281765460968\n",
            "2.123477550148964\n",
            "2.113244304656982\n",
            "2.1211091554164887\n",
            "1.9788016998767852\n",
            "1.9814996135234832\n",
            "2.166627978682518\n",
            "2.1832705026865007\n",
            "2.2642293727397917\n",
            "2.1290106844902037\n",
            "1.9234018689393997\n",
            "2.083018717169762\n",
            "2.0762912690639497\n",
            "2.3715258514881135\n",
            "1.9299801003932953\n",
            "2.1723218435049056\n",
            "2.3019465577602385\n",
            "2.0128758686780928\n",
            "2.0947281634807586\n",
            "2.1594678491353987\n",
            "2.026862415075302\n",
            "2.123659453690052\n",
            "1.9302495002746582\n",
            "2.2238160651922225\n",
            "2.3270809519290925\n",
            "2.0574926275014875\n",
            "2.131647480726242\n",
            "2.2512045496702195\n",
            "1.979605545401573\n",
            "1.8474838030338288\n",
            "2.045746463537216\n",
            "2.0861032438278198\n",
            "2.235365785956383\n",
            "2.3624643266201018\n",
            "1.9853919494152068\n",
            "2.0138512539863584\n",
            "2.3410577857494355\n",
            "2.2241520607471466\n",
            "2.159465855360031\n",
            "2.093420299887657\n",
            "2.0433717703819276\n",
            "2.124189004898071\n",
            "1.9068780797719955\n",
            "1.9495709037780762\n",
            "1.9425176352262497\n",
            "1.9839992558956145\n",
            "2.2524541747570037\n",
            "2.3246297526359556\n",
            "2.2241075193881987\n",
            "2.2783376586437227\n",
            "2.1659671485424044\n",
            "2.3020271456241606\n",
            "2.1861633968353273\n",
            "2.266040915250778\n",
            "2.310430028438568\n",
            "2.1926783615350725\n",
            "2.239380183815956\n",
            "2.273680794239044\n",
            "2.113369660973549\n",
            "2.1756089156866074\n",
            "2.2485955321788786\n",
            "2.190253496170044\n",
            "2.253792835474014\n",
            "2.1555856585502626\n",
            "2.2265137362480165\n",
            "2.174488679766655\n",
            "2.145038323998451\n",
            "2.19581291615963\n",
            "2.1819023978710175\n",
            "2.0295048719644546\n",
            "2.2287501817941666\n",
            "2.195515967607498\n",
            "2.215465165376663\n",
            "2.1278041672706602\n",
            "2.156990992426872\n",
            "2.145747277140617\n",
            "2.2528463023900986\n",
            "2.1330060970783236\n",
            "2.2148799788951874\n",
            "2.072087535858154\n",
            "2.1460163593292236\n",
            "2.1049662959575652\n",
            "2.0783514732122423\n",
            "2.1140177059173584\n",
            "2.1246024572849276\n",
            "2.208634388446808\n",
            "2.2138449394702913\n",
            "2.167506008148193\n",
            "2.2637178140878675\n",
            "2.1021006393432615\n",
            "2.2332548230886458\n",
            "2.178526076078415\n",
            "2.1435289001464843\n",
            "2.235853068828583\n",
            "2.156348324418068\n",
            "2.1089713406562804\n",
            "2.230934317111969\n",
            "2.241320472955704\n",
            "2.178123396039009\n",
            "2.2835544323921204\n",
            "2.3038208425045013\n",
            "2.2073476481437684\n",
            "2.117778943181038\n",
            "2.2623590528964996\n",
            "2.043943049311638\n",
            "2.2319225430488587\n",
            "2.108506285250187\n",
            "2.199899670481682\n",
            "2.3377526223659517\n",
            "2.2790148788690567\n",
            "2.324550598859787\n",
            "2.126154300570488\n",
            "2.1917104935646057\n",
            "2.146828456521034\n",
            "2.1667184126377106\n",
            "2.3880095541477204\n",
            "2.150947420597076\n",
            "2.2742455792427063\n",
            "2.261156105995178\n",
            "2.270713554620743\n",
            "2.2886524415016174\n",
            "2.1827892088890075\n",
            "2.206423408985138\n",
            "2.188236780166626\n",
            "2.2223702836036683\n",
            "2.328606437444687\n",
            "2.1631366407871244\n",
            "2.325165125131607\n",
            "2.216356756091118\n",
            "2.102588962316513\n",
            "2.1447321602702143\n",
            "2.1361784601211546\n",
            "2.326640409231186\n",
            "2.537360838651657\n",
            "2.134154039621353\n",
            "2.1812539964914324\n",
            "2.20517045378685\n",
            "2.102627632021904\n",
            "2.175119342803955\n",
            "2.3098390555381774\n",
            "2.3499901443719864\n",
            "2.197138661146164\n",
            "2.333219281435013\n",
            "2.113579524755478\n",
            "2.0559274476766585\n",
            "2.216133833527565\n",
            "2.2700501716136934\n",
            "2.3100246280431747\n",
            "2.3350773704051973\n",
            "2.0890531086921693\n",
            "2.2470381444692613\n",
            "2.267061986923218\n",
            "2.283092694878578\n",
            "2.2750466310977937\n",
            "2.2519415217638015\n",
            "2.0588556009531023\n",
            "2.3421106827259064\n",
            "2.3581226515769957\n",
            "2.2389181530475617\n",
            "2.3495349150896074\n",
            "2.2566685581207278\n",
            "2.177375991344452\n",
            "2.407362722158432\n",
            "2.131572703719139\n",
            "2.213390642404556\n",
            "2.170686873793602\n",
            "2.1834460258483888\n",
            "2.205309023857117\n",
            "2.013784506618977\n",
            "2.1078563791513445\n",
            "2.346368478536606\n",
            "2.370609539747238\n",
            "2.4116451501846314\n",
            "2.4357163870334624\n",
            "2.0480161941051485\n",
            "2.054493569135666\n",
            "2.2670816671848297\n",
            "2.3404467403888702\n",
            "2.2224008518457414\n",
            "2.1417975389957427\n",
            "2.169688510894775\n",
            "2.265547742843628\n",
            "2.189574427604675\n",
            "2.077151110172272\n",
            "2.243199064731598\n",
            "2.079457102417946\n",
            "2.107244672179222\n",
            "2.2510934853553772\n",
            "2.344339469671249\n",
            "2.244517295360565\n",
            "2.444951692819595\n",
            "2.2794798004627226\n",
            "2.314432495832443\n",
            "2.139028517603874\n",
            "2.03355928003788\n",
            "2.031233144402504\n",
            "2.1191645085811617\n",
            "2.0375819462537765\n",
            "2.0106653785705566\n",
            "1.818971520960331\n",
            "1.904902542233467\n",
            "2.015103710889816\n",
            "2.0659893238544464\n",
            "2.0248151850700378\n",
            "2.0278892332315444\n",
            "2.082219581604004\n",
            "2.0569947123527528\n",
            "2.0481582289934157\n",
            "1.980947686433792\n",
            "2.050263198018074\n",
            "2.001106634736061\n",
            "2.0809916627407072\n",
            "1.9887770092487336\n",
            "2.0807118892669676\n",
            "2.0468537253141403\n",
            "2.052691980600357\n",
            "2.0990719091892243\n",
            "2.0758132940530776\n",
            "1.9549638885259628\n",
            "2.072898267507553\n",
            "2.047896717786789\n",
            "2.048193593621254\n",
            "2.074599880576134\n",
            "1.9470809805393219\n",
            "1.9620688366889953\n",
            "1.9190278550982476\n",
            "1.9573546010255813\n",
            "1.9558599120378495\n",
            "1.9192664682865144\n",
            "1.9620994901657105\n",
            "2.1316165697574614\n",
            "2.052819368839264\n",
            "2.05519217133522\n",
            "2.0900354170799256\n",
            "2.087932321727276\n",
            "1.9443492245674134\n",
            "2.055458519458771\n",
            "2.058884130716324\n",
            "2.017070534825325\n",
            "2.026192750930786\n",
            "2.027784523367882\n",
            "1.9368121969699859\n",
            "1.9323527228832245\n",
            "2.0178847068548205\n",
            "2.0679833871126174\n",
            "1.964093496799469\n",
            "2.125905526280403\n",
            "1.9971770668029785\n",
            "2.051480622291565\n",
            "1.9202505826950074\n",
            "2.013198754787445\n",
            "1.9596250063180924\n",
            "2.0529326352477075\n",
            "2.0985908943414686\n",
            "2.0959352284669874\n",
            "2.0245421516895292\n",
            "1.9424698573350907\n",
            "1.9323797416687012\n",
            "2.1574219608306886\n",
            "2.078023369908333\n",
            "2.0409280955791473\n",
            "2.00097746193409\n",
            "2.0074450638890267\n",
            "2.0198098826408386\n",
            "2.095132575035095\n",
            "1.962412978410721\n",
            "2.053282097876072\n",
            "2.112044014930725\n",
            "1.9534610331058502\n",
            "2.1742671447992326\n",
            "2.1444186437129975\n",
            "1.998143037557602\n",
            "1.9340166068077087\n",
            "2.136091204881668\n",
            "2.0550440698862076\n",
            "2.0764190375804903\n",
            "1.9646172311902046\n",
            "2.013426355719566\n",
            "2.008056961596012\n",
            "1.9999424070119858\n",
            "2.132811067700386\n",
            "1.9950698852539062\n",
            "1.9715268456935882\n",
            "2.150331833064556\n",
            "1.9194746226072312\n",
            "2.0672244799137114\n",
            "2.1507724291086197\n",
            "1.9756564778089523\n",
            "2.0582934892177582\n",
            "2.1736573112010955\n",
            "1.9785304737091065\n",
            "2.1053070545196535\n",
            "2.0653443306684496\n",
            "2.177797245085239\n",
            "2.0118112099170684\n",
            "1.9670411103963852\n",
            "2.230032051205635\n",
            "2.194360247850418\n",
            "1.8950984427332878\n",
            "2.1962508255243303\n",
            "2.045697969198227\n",
            "2.087622697353363\n",
            "1.992579574584961\n",
            "1.924569154381752\n",
            "2.2026995277404784\n",
            "2.2194833111763\n",
            "1.9917683601379395\n",
            "1.953966708779335\n",
            "2.1858891397714615\n",
            "2.0414752370119094\n",
            "2.149460260272026\n",
            "2.097583206295967\n",
            "1.856093989610672\n",
            "1.9341055124998092\n",
            "2.2692505329847337\n",
            "2.2030755281448364\n",
            "2.0508848053216933\n",
            "1.8626483860611915\n",
            "2.0356846022605897\n",
            "2.251573144197464\n",
            "1.867309067249298\n",
            "2.222273392677307\n",
            "2.049381083250046\n",
            "1.98395259141922\n",
            "2.020483918786049\n",
            "1.953562770485878\n",
            "2.087890706658363\n",
            "2.105523493885994\n",
            "2.2388835334777832\n",
            "2.2072563511133194\n",
            "1.892154302597046\n",
            "2.037809293270111\n",
            "2.045563646554947\n",
            "2.307683004140854\n",
            "2.0514822936058046\n",
            "1.9236716544628143\n",
            "2.4275514686107638\n",
            "1.9682846027612686\n",
            "2.0953423327207563\n",
            "2.0303916305303575\n",
            "2.156551822423935\n",
            "2.007191555202007\n",
            "2.044872110486031\n",
            "1.999310930967331\n",
            "2.3539527106285094\n",
            "2.1160145169496536\n",
            "2.149218406677246\n",
            "2.15147640645504\n",
            "2.0438731318712233\n",
            "1.8595917874574661\n",
            "1.9022855591773986\n",
            "2.07867739379406\n",
            "2.1995895874500273\n",
            "2.2818624639511107\n",
            "2.13607607960701\n",
            "1.9990119069814682\n",
            "2.131875866651535\n",
            "2.3631229305267336\n",
            "2.1193506050109865\n",
            "2.153527969121933\n",
            "1.9985312455892563\n",
            "2.1113433319330217\n",
            "1.897676526904106\n",
            "1.9917428755760194\n",
            "1.8973713076114656\n",
            "1.9609858727455138\n",
            "2.110763029456139\n",
            "2.2452286529541015\n",
            "2.3564599609375\n",
            "2.1371728909015655\n",
            "2.188653473854065\n",
            "2.338044339418411\n",
            "2.175115897655487\n",
            "2.244793512225151\n",
            "2.283792886734009\n",
            "2.163713184595108\n",
            "2.176826454997063\n",
            "2.25622322678566\n",
            "2.117673560380936\n",
            "2.137068463563919\n",
            "2.297509742975235\n",
            "2.115236858725548\n",
            "2.2551207262277604\n",
            "2.1687309354543687\n",
            "2.1398932445049286\n",
            "2.138799740076065\n",
            "2.1857782077789305\n",
            "2.178049471974373\n",
            "2.137103173136711\n",
            "2.05081620156765\n",
            "2.161372678875923\n",
            "2.1222714805603027\n",
            "2.260102636218071\n",
            "2.1227285397052764\n",
            "2.1072373712062835\n",
            "2.087193777561188\n",
            "2.2907127821445465\n",
            "2.1517105615139007\n",
            "2.0714679980278015\n",
            "2.1725117629766464\n",
            "2.1346687132120135\n",
            "2.1265141654014585\n",
            "1.9795788156986236\n",
            "2.107975462079048\n",
            "2.124394874572754\n",
            "2.1593595945835116\n",
            "2.1620605218410494\n",
            "2.2068011957406997\n",
            "2.187517676949501\n",
            "2.1595691829919814\n",
            "2.157472921013832\n",
            "2.148050553202629\n",
            "2.157196729183197\n",
            "2.1775880432128907\n",
            "2.1876136058568956\n",
            "2.0821592420339585\n",
            "2.1862810921669005\n",
            "2.265983695983887\n",
            "2.1672456634044646\n",
            "2.1784292310476303\n",
            "2.280265885591507\n",
            "2.275948963165283\n",
            "2.0484852427244187\n",
            "2.2269894915819166\n",
            "2.1314046931266786\n",
            "2.139752444624901\n",
            "2.1872529977560045\n",
            "2.064475047588348\n",
            "2.287221305370331\n",
            "2.201639828681946\n",
            "2.30712308883667\n",
            "2.2552263832092283\n",
            "2.106206166744232\n",
            "2.1413804668188097\n",
            "2.130625377893448\n",
            "2.3301961815357206\n",
            "2.157595511674881\n",
            "2.2538045972585676\n",
            "2.182820637822151\n",
            "2.367391049861908\n",
            "2.21062332034111\n",
            "2.2001012599468233\n",
            "2.12396053314209\n",
            "2.2584377229213715\n",
            "2.110523139834404\n",
            "2.2894229388236997\n",
            "2.242016540169716\n",
            "2.1682331597805025\n",
            "2.387334718108177\n",
            "2.0346813398599624\n",
            "2.157631142735481\n",
            "2.102387669980526\n",
            "2.191660835146904\n",
            "2.5161401998996733\n",
            "2.2035667663812637\n",
            "2.2330778563022613\n",
            "2.1366274946928026\n",
            "2.0110727071762087\n",
            "2.1797186976671217\n",
            "2.19370310485363\n",
            "2.3984376645088195\n",
            "2.1717954713106153\n",
            "2.3287136322259903\n",
            "2.152539210319519\n",
            "2.101438663601875\n",
            "2.0859311664104463\n",
            "2.1782378697395326\n",
            "2.2777081686258316\n",
            "2.3690219378471373\n",
            "2.15680356413126\n",
            "2.1534954369068147\n",
            "2.2831713551282884\n",
            "2.177073664665222\n",
            "2.2365139293670655\n",
            "2.2987155151367187\n",
            "2.2236622965335844\n",
            "2.100984644293785\n",
            "2.395916368961334\n",
            "2.2786392456293108\n",
            "2.345166677236557\n",
            "2.2010106658935547\n",
            "2.1551206243038177\n",
            "2.427103943824768\n",
            "2.121294611096382\n",
            "2.093151673078537\n",
            "2.2888925647735596\n",
            "2.2546521997451783\n",
            "2.023877007365227\n",
            "2.191109555363655\n",
            "1.9086387541890144\n",
            "2.3569705522060396\n",
            "2.3492165529727935\n",
            "2.3661825931072236\n",
            "2.3012419426441193\n",
            "2.2823299956321716\n",
            "2.0128248888254165\n",
            "2.276587141752243\n",
            "2.270923819541931\n",
            "2.1238573217391967\n",
            "2.1740180587768556\n",
            "2.2271825939416887\n",
            "2.2599808353185655\n",
            "2.1073335164785387\n",
            "2.16638681769371\n",
            "2.0307469046115876\n",
            "2.2039995294809342\n",
            "2.0293914926052095\n",
            "2.2585260033607484\n",
            "2.3144379448890686\n",
            "2.194957993030548\n",
            "2.4508356857299805\n",
            "2.3112464344501493\n",
            "2.245159036517143\n",
            "2.1889960592985154\n",
            "2.043709646463394\n",
            "2.029651050567627\n",
            "2.0656909215450288\n",
            "2.073606698513031\n",
            "1.9698684471845627\n",
            "1.865500745177269\n",
            "1.925524741411209\n",
            "1.90472901314497\n",
            "2.0276761400699614\n",
            "2.0116333413124083\n",
            "2.0674864250421523\n",
            "1.941375784277916\n",
            "2.1229685235023497\n",
            "2.051545951962471\n",
            "1.991771644949913\n",
            "1.9408779430389405\n",
            "2.0465355849266054\n",
            "2.0622744643688202\n",
            "2.0576438194513322\n",
            "1.9618861508369445\n",
            "2.0728121960163115\n",
            "1.9896539914608002\n",
            "2.0493902230262755\n",
            "2.0970955729484557\n",
            "2.024205605983734\n",
            "1.9463851273059845\n",
            "2.019159033894539\n",
            "2.0490413409471513\n",
            "2.048442858457565\n",
            "1.9675590473413467\n",
            "1.9656453239917755\n",
            "1.83133049339056\n",
            "1.9486372178792954\n",
            "1.9596658462285996\n",
            "1.9071179687976838\n",
            "1.8842174765467643\n",
            "2.1027924007177354\n",
            "2.0788705480098724\n",
            "2.033771996796131\n",
            "2.0076928886771204\n",
            "2.1206174752116205\n",
            "1.9505564153194428\n",
            "2.042287068963051\n",
            "2.0474131911993028\n",
            "2.0147663432359697\n",
            "1.9745155715942382\n",
            "1.9665121537446977\n",
            "1.987621295452118\n",
            "1.9404739388823509\n",
            "1.9631372541189194\n",
            "2.0729457944631577\n",
            "1.9847503471374512\n",
            "2.1115940058231355\n",
            "1.9301764398813248\n",
            "2.0559352159500124\n",
            "1.9331288999319076\n",
            "1.9552922904491425\n",
            "1.9832980185747147\n",
            "1.9723140811920166\n",
            "2.0407947158813475\n",
            "2.057288649082184\n",
            "2.0549837720394133\n",
            "2.027768834233284\n",
            "1.8960798519849777\n",
            "1.9807423448562622\n",
            "2.1327998089790343\n",
            "2.0515596997737884\n",
            "1.9585988894104958\n",
            "1.9925455948710442\n",
            "2.012948872447014\n",
            "2.122098101377487\n",
            "1.927736029624939\n",
            "1.9350223430991174\n",
            "2.2219422036409378\n",
            "1.997838116288185\n",
            "2.05508807182312\n",
            "2.041484586596489\n",
            "2.0623030441999437\n",
            "1.9818310743570329\n",
            "2.1148343223333357\n",
            "1.9668806689977645\n",
            "2.044814475774765\n",
            "2.1012752813100817\n",
            "1.8178864634037017\n",
            "2.045481606423855\n",
            "2.0488761377334597\n",
            "2.0461641865968705\n",
            "2.0812848991155626\n",
            "1.8630595552921294\n",
            "2.1746723636984826\n",
            "1.8198929333686829\n",
            "2.164774115085602\n",
            "2.0370027285814287\n",
            "2.0022780114412306\n",
            "1.8798589634895324\n",
            "2.192492172718048\n",
            "2.1390701723098755\n",
            "1.9341966825723649\n",
            "2.109176751971245\n",
            "2.096964059174061\n",
            "2.12873968064785\n",
            "1.9112309175729751\n",
            "2.168544995188713\n",
            "2.258309308886528\n",
            "1.9238610446453095\n",
            "2.0284705859422685\n",
            "2.0560032081604005\n",
            "2.108862347602844\n",
            "2.0253010153770448\n",
            "2.0021464115381242\n",
            "1.977246578335762\n",
            "2.2536322689056396\n",
            "2.157464210987091\n",
            "1.8507716250419617\n",
            "2.233061359524727\n",
            "1.9293987214565278\n",
            "2.1880908972024917\n",
            "2.066711539030075\n",
            "1.8499010050296782\n",
            "1.9174916821718215\n",
            "2.1752708196640014\n",
            "2.1582770854234696\n",
            "2.1271530425548555\n",
            "1.839851166009903\n",
            "2.061142313480377\n",
            "2.152557100057602\n",
            "1.977497775554657\n",
            "2.0466478258371352\n",
            "1.996391300559044\n",
            "2.0363356149196625\n",
            "2.014940359592438\n",
            "1.9869905245304107\n",
            "1.9802864623069762\n",
            "2.1522553211450575\n",
            "2.1447578585147857\n",
            "2.1495662260055544\n",
            "2.021126589179039\n",
            "2.074991689324379\n",
            "1.8715534192323684\n",
            "2.211754705309868\n",
            "2.267733026742935\n",
            "1.8830471062660217\n",
            "2.3029567658901215\n",
            "2.0812945306301116\n",
            "2.060645416378975\n",
            "2.033021088242531\n",
            "2.231401835680008\n",
            "1.9513765025138854\n",
            "2.003314189016819\n",
            "1.9045837378501893\n",
            "2.2710551488399506\n",
            "2.239242339134216\n",
            "2.068738157749176\n",
            "2.0717716181278227\n",
            "2.0782539653778076\n",
            "1.9421370446681976\n",
            "1.7825625616312026\n",
            "2.0822722941637037\n",
            "2.0317987471818926\n",
            "2.314944256544113\n",
            "2.229641706943512\n",
            "1.9719220691919326\n",
            "2.106555309295654\n",
            "2.311352914571762\n",
            "2.141429215669632\n",
            "2.1534800004959105\n",
            "1.9857042092084884\n",
            "2.056114086508751\n",
            "2.045586184859276\n",
            "1.94030941426754\n",
            "1.935425438284874\n",
            "1.8393803548812866\n",
            "2.0573876732587815\n",
            "2.2766544461250304\n",
            "2.3091733717918395\n",
            "2.13979566693306\n",
            "2.187800407409668\n",
            "2.28352103471756\n",
            "2.178162399530411\n",
            "2.199151898622513\n",
            "2.2265391498804092\n",
            "2.229807015657425\n",
            "2.17710488319397\n",
            "2.172965729832649\n",
            "2.1951711040735247\n",
            "2.0786342453956603\n",
            "2.1948217207193377\n",
            "2.215669330358505\n",
            "2.1392836809158324\n",
            "2.1772351056337356\n",
            "2.1799863064289093\n",
            "2.1228006702661513\n",
            "2.167913070321083\n",
            "2.1575838124752043\n",
            "2.109769426584244\n",
            "2.0490008974075318\n",
            "2.061104345023632\n",
            "2.147182726264\n",
            "2.2441191017627715\n",
            "2.083650949001312\n",
            "2.173284074664116\n",
            "2.0989044374227523\n",
            "2.1927232086658477\n",
            "2.1829212152957918\n",
            "2.061816010475159\n",
            "2.1919843530654908\n",
            "2.0969711035490035\n",
            "2.09985999584198\n",
            "1.9420234006643295\n",
            "2.1255101490020754\n",
            "2.0724374163150787\n",
            "2.1178414726257326\n",
            "2.1981585383415223\n",
            "2.227092580199242\n",
            "2.081148073673248\n",
            "2.203958745598793\n",
            "2.1294646072387695\n",
            "2.0537979686260224\n",
            "2.1651641261577605\n",
            "2.170044578909874\n",
            "2.168987307548523\n",
            "2.0816269230842592\n",
            "2.1660438907146453\n",
            "2.2204848873615264\n",
            "2.172142009139061\n",
            "2.2149920600652693\n",
            "2.2307864117622374\n",
            "2.211123684644699\n",
            "2.162710839509964\n",
            "2.158341110944748\n",
            "2.145281686782837\n",
            "2.0561223894357683\n",
            "2.260830936431885\n",
            "1.9500181010365487\n",
            "2.2370823001861573\n",
            "2.2647745448350904\n",
            "2.271841113567352\n",
            "2.237938245534897\n",
            "2.0436691772937774\n",
            "2.142805191874504\n",
            "2.1817904925346374\n",
            "2.155661664009094\n",
            "2.2834788972139357\n",
            "2.178136493563652\n",
            "2.1975576627254485\n",
            "2.276974643468857\n",
            "2.235822104215622\n",
            "2.23341960310936\n",
            "2.095090788602829\n",
            "2.1969921731948854\n",
            "2.096959639787674\n",
            "2.260205093622208\n",
            "2.2075688529014585\n",
            "2.247645778656006\n",
            "2.328602139353752\n",
            "2.097986538410187\n",
            "2.1178534138202667\n",
            "2.148297827243805\n",
            "2.028718571662903\n",
            "2.446341965198517\n",
            "2.383996798992157\n",
            "2.180233615040779\n",
            "2.0972996228933334\n",
            "2.114204170703888\n",
            "2.0417515408992766\n",
            "2.1475886476039885\n",
            "2.4324857848882675\n",
            "2.1751539486646654\n",
            "2.207194917201996\n",
            "2.198012872338295\n",
            "2.0931488543748857\n",
            "2.0342049419879915\n",
            "2.1603682827949524\n",
            "2.2266481006145478\n",
            "2.365458301305771\n",
            "2.2732988354563712\n",
            "1.9973699975013732\n",
            "2.323161624073982\n",
            "2.1190465915203096\n",
            "2.3360951602458955\n",
            "2.2505468308925627\n",
            "2.171773954629898\n",
            "2.0189615333080293\n",
            "2.4566923856735228\n",
            "2.2707963180541992\n",
            "2.311069039106369\n",
            "2.2609479928016665\n",
            "2.105690907239914\n",
            "2.2365966856479647\n",
            "2.2974463802576066\n",
            "2.0564312392473223\n",
            "2.3185282385349275\n",
            "2.0869078183174135\n",
            "2.1416511791944504\n",
            "2.2856209588050844\n",
            "1.8425897377729417\n",
            "2.2700217932462694\n",
            "2.2075260347127914\n",
            "2.4104635846614837\n",
            "2.3860700607299803\n",
            "2.290731013417244\n",
            "2.0861609613895418\n",
            "2.1107946288585664\n",
            "2.1861614561080933\n",
            "2.24113874912262\n",
            "2.2156397354602815\n",
            "2.2004098439216615\n",
            "2.1969525825977327\n",
            "2.0887765592336653\n",
            "2.3190297150611876\n",
            "1.884844645857811\n",
            "2.316325761079788\n",
            "1.9961992901563645\n",
            "2.1211942809820177\n",
            "2.283852733373642\n",
            "2.201772792339325\n",
            "2.42695885181427\n",
            "2.2598605704307557\n",
            "2.3351671576499937\n"
          ]
        }
      ],
      "source": [
        "total_loss = 0\n",
        "total_ct = 0\n",
        "total_epochs = 5\n",
        "\n",
        "for _ in range(total_epochs):\n",
        "    for name in open('/content/names-1.txt', 'r'):\n",
        "        name = name.lower().strip()\n",
        "        # Pad the name with a special token for start and stop; use the same token\n",
        "        name = '.' + name + '.'\n",
        "\n",
        "        # Add the start and end padding token; reshape as needed\n",
        "        # Batch size is 1 here\n",
        "        x_data = [[stoi[ch] for ch in name[:-1]]]\n",
        "        y_data = [[stoi[ch] for ch in name[1:]]]\n",
        "\n",
        "        # Get the logits acrosss the x_data above\n",
        "        logits = model(torch.tensor(x_data))\n",
        "\n",
        "        # Compute the loss\n",
        "        loss = F.cross_entropy(logits.reshape(-1, vocab_size), torch.tensor(y_data).view(-1))\n",
        "\n",
        "        # Get the new gradient\n",
        "        optimizer.zero_grad()\n",
        "        loss.backward()\n",
        "\n",
        "        # Clip the gradients at max norm 0.1\n",
        "        torch.nn.utils.clip_grad_norm_(model.parameters(), max_norm=0.1)\n",
        "\n",
        "        # Do a gradient update\n",
        "        optimizer.step()\n",
        "\n",
        "        # Get the loss for the batch and get the number of batches\n",
        "        total_loss += loss.item()\n",
        "        total_ct += 1\n",
        "\n",
        "        if total_ct and total_ct % 100 == 0:\n",
        "            print(total_loss / total_ct)\n",
        "            total_loss = 0\n",
        "            total_ct = 0"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 76,
      "id": "f3063e78",
      "metadata": {
        "id": "f3063e78",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "89cb85eb-4aa1-4f76-de80-a7ffd27f0bcb"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Perplexity:  9.501129539232501\n"
          ]
        }
      ],
      "source": [
        "with torch.no_grad():\n",
        "    # Get perplexity\n",
        "    sumneglogp = 0\n",
        "    T = 0\n",
        "    for name in open('/content/names-1.txt', 'r'):\n",
        "        name = name.lower().strip()\n",
        "        T += len(name) + 1\n",
        "        name = '.' + name + '.'\n",
        "\n",
        "        # Get the name from index 0 to -1 exclusive end\n",
        "        x_data = [[stoi[ch] for ch in name[:-1]]]\n",
        "\n",
        "        # Get the y from index 1 to end inclusive end\n",
        "        y_data = [[stoi[ch] for ch in name[1:]]]\n",
        "\n",
        "        # logits per token prediction\n",
        "        logits = model(torch.tensor(x_data))\n",
        "\n",
        "        # Compute the loss\n",
        "        loss = F.cross_entropy(logits.reshape(-1, vocab_size), torch.tensor(y_data).view(-1), reduction='sum')\n",
        "\n",
        "        # Change to log base 2\n",
        "        # log2(x) = ln(x) / ln(2)\n",
        "        loss *= (1 / math.log(2))\n",
        "\n",
        "        # Update the sum across the negative logs\n",
        "        sumneglogp += loss.item()\n",
        "\n",
        "    # sumneglogp is -log(p('.' + name1)) -log(p('.' + name2)) -log(p('.' + name3)) ...\n",
        "\n",
        "    # Divide by the appropriate term to get the answer we want\n",
        "    print('Perplexity: ', 2 ** (sumneglogp / T))"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "928daac2",
      "metadata": {
        "id": "928daac2"
      },
      "outputs": [],
      "source": []
    },
    {
      "cell_type": "code",
      "execution_count": 79,
      "id": "01b18614",
      "metadata": {
        "id": "01b18614",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "68876e90-6532-4b7a-aba1-c3ad80cb5520"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Generated name:  ma\n"
          ]
        }
      ],
      "source": [
        "# Generate a random word using this distributon\n",
        "# Intialize the word with\n",
        "name = '.'\n",
        "i_name = []\n",
        "while True:\n",
        "    # Get the last character and and add to i_name as an int representation\n",
        "    l = stoi[name[-1]]\n",
        "    i_name.append(l)\n",
        "\n",
        "    # Make the distribution from c to any other word other than START\n",
        "    logits = model(torch.tensor([i_name]))\n",
        "\n",
        "    # Grab the last logits, for the new term\n",
        "    # Alternatively, just push the appropriate amount into the model\n",
        "    logits = logits[:, :, -1]\n",
        "\n",
        "    # Get the probabilities\n",
        "    p = torch.softmax(logits, dim=1)\n",
        "\n",
        "    # Sample from the above probability distribution\n",
        "    c = torch.multinomial(p, 1)\n",
        "\n",
        "    # If we sample 0, stop; otherwise, continue\n",
        "    if itos[c.item()] == '.':\n",
        "        break\n",
        "    else:\n",
        "        name += itos[c.item()]\n",
        "print('Generated name: ' , name[1:])"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "1247eade",
      "metadata": {
        "id": "1247eade"
      },
      "outputs": [],
      "source": []
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "ef69bd60",
      "metadata": {
        "id": "ef69bd60"
      },
      "outputs": [],
      "source": []
    }
  ],
  "metadata": {
    "kernelspec": {
      "display_name": "Python 3",
      "name": "python3"
    },
    "language_info": {
      "codemirror_mode": {
        "name": "ipython",
        "version": 3
      },
      "file_extension": ".py",
      "mimetype": "text/x-python",
      "name": "python",
      "nbconvert_exporter": "python",
      "pygments_lexer": "ipython3",
      "version": "3.8.15"
    },
    "colab": {
      "provenance": [],
      "gpuType": "T4"
    },
    "accelerator": "GPU"
  },
  "nbformat": 4,
  "nbformat_minor": 5
}
